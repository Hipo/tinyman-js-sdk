"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("algosdk"),e=require("base64-js");function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(t),s=Uint8Array.from([1]);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var s=e&&e.prototype instanceof d?e:d,a=Object.create(s.prototype),o=new v(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(s,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===s)throw a;return N()}for(n.method=s,n.arg=a;;){var o=n.delegate;if(o){var i=y(o,n);if(i){if(i===l)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=p(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,o),a}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function d(){}function f(){}function I(){}var A={};u(A,s,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(_([])));g&&g!==e&&n.call(g,s)&&(A=g);var x=I.prototype=d.prototype=Object.create(A);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function h(t,e){function r(s,a,o,i){var u=p(t[s],t,a);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,o,i)}),(function(t){r("throw",t,o,i)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,i)}))}i(u.arg)}var s;this._invoke=function(t,n){function a(){return new e((function(e,s){r(t,n,e,s)}))}return s=s?s.then(a,a):a()}}function y(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,y(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=p(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var s=r.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function v(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:N}}function N(){return{value:void 0,done:!0}}return f.prototype=I,u(x,"constructor",I),u(I,"constructor",f),f.displayName=u(I,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,I):(t.__proto__=I,u(t,o,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},T(h.prototype),u(h.prototype,a,(function(){return this})),t.AsyncIterator=h,t.async=function(e,n,r,s,a){void 0===a&&(a=Promise);var o=new h(c(e,n,r,s),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(x),u(x,o,"Generator"),u(x,s,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,v.prototype={constructor:v,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var i=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(i&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var a=s;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var s=r.arg;D(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function u(t,e,n,r,s,a,o){try{var i=t[a](o),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,s)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){u(a,r,s,o,i,"next",t)}function i(t){u(a,r,s,o,i,"throw",t)}o(void 0)}))}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function x(t,e,n){return x=g()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var s=new(Function.bind.apply(t,r));return n&&m(s,n.prototype),s},x.apply(null,arguments)}function T(t){var e="function"==typeof Map?new Map:void 0;return T=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return x(t,arguments,A(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),m(r,t)},T(t)}function h(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){var e=g();return function(){var n,r=A(t);if(e){var s=A(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return h(this,n)}}function E(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,s,a=[],o=!0,i=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(a.push(r.value),!e||a.length!==e);o=!0);}catch(t){i=!0,s=t}finally{try{o||null==n.return||n.return()}finally{if(i)throw s}}return a}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function N(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=v(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){i=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}var w="- would result negative",S="logic eval error:",b="exceeds schema integer count",P=/transaction \w+:/,k=function(t){I(n,T(Error));var e=y(n);function n(t,r){var s;p(this,n);for(var a=arguments.length,o=new Array(a>2?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];var u=(s=e.call.apply(e,[this].concat(o))).extractMessageFromAlgoSDKError(t);return s.data=t,s.type=s.getErrorType(u),s.setMessage(s.getErrorMessage(u,s.type,r)),s}return d(n,[{key:"setMessage",value:function(t){this.message=t}},{key:"getErrorType",value:function(t){var e="Unknown";return t.includes(w)?e="SlippageTolerance":t.includes(b)?e="ExceedingExcessAmountCount":t.includes(S)?e="LogicError":t.match(P)&&(e="TransactionError"),e}},{key:"getErrorMessage",value:function(t,e,n){var r;switch(e){case"SlippageTolerance":r="The process failed due to too much slippage in the price. Please adjust the slippage tolerance and try again.";break;case"ExceedingExcessAmountCount":r="The process failed due to the number of excess amounts accumulated for your account in the Tinyman app.";break;case"LogicError":r=t.split(S)[1];break;case"TransactionError":r=t.split(P)[1];break;case"Unknown":t&&(r=t)}return r||(r=n||"We encountered an unexpected error, try again later."),r.trim()}},{key:"extractMessageFromAlgoSDKError",value:function(t){var e,n,r,s="";return null!=t&&null!==(e=t.response)&&void 0!==e&&null!==(n=e.body)&&void 0!==n&&n.message?s=t.response.body.message:null!=t&&null!==(r=t.response)&&void 0!==r&&r.text?s=t.response.text:"string"==typeof(null==t?void 0:t.message)&&(s=this.isMessageObjectString(null==t?void 0:t.message)?JSON.parse(t.message||"{message: ''}").message:t.message),"string"!=typeof s&&(s=String(s)),s}},{key:"isMessageObjectString",value:function(t){return"string"==typeof t&&t.includes("{message:")}}]),n}();function R(t){var e,n=t.stateArray,r=void 0===n?[]:n,s=t.shouldDecodeKeys,a=void 0!==s&&s,o={},i=N(r);try{for(i.s();!(e=i.n()).done;){var u=e.value,c=u.key,p=void 0;if(1==u.value.type)p=u.value.bytes;else{if(2!=u.value.type)throw new Error("Unexpected state type: ".concat(u.value.type));p=u.value.uint}o[a?atob(c):c]=p}}catch(t){i.e(t)}finally{i.f()}return o}function O(t){var e,n=t.reduce((function(t,e){return t+e.length}),0),r=new Uint8Array(n),s=0,a=N(t);try{for(a.s();!(e=a.n()).done;){var o=e.value;r.set(o,s),s+=o.length}}catch(t){a.e(t)}finally{a.f()}return r}var B=100000n,M=100000n,Q=100000n,L=25000n+25000n,F=25000n+3500n;function C(t){var e=t["apps-total-schema"],n=0n,r=0n;e&&(e["num-byte-slice"]&&(n=e["num-byte-slice"]),e["num-uint"]&&(r=e["num-uint"]));var s=t["apps-local-state"]||[],a=t["created-apps"]||[],o=t.assets||[];return B+M*BigInt(o.length)+Q*BigInt(a.length+s.length)+F*r+L*n}function U(t){return new Promise((function(e){setTimeout((function(){e(null)}),t)}))}function j(t,e){return V.apply(this,arguments)}function V(){return(V=c(i().mark((function t(e,n){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,U(1e3);case 3:return r=null,t.prev=4,t.next=7,e.pendingTransactionInformation(n).do();case 7:r=t.sent,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(4);case 12:if(!r){t.next=17;break}if(!r["confirmed-round"]){t.next=15;break}return t.abrupt("return",r);case 15:if(!r["pool-error"]){t.next=17;break}throw new Error("Transaction Rejected: ".concat(r["pool-error"]));case 17:t.next=0;break;case 19:case"end":return t.stop()}}),t,null,[[4,10]])})))).apply(this,arguments)}function X(t,e,n){if(e>1||e<0)throw new Error("Invalid slippage value. Must be between 0 and 1, got ".concat(e));var r;try{var s="negative"===t?1-e:1+e;r=BigInt(Math.floor(Number(n)*s))}catch(t){throw new Error(t.message)}return r}function q(t,e){var n=Number(t);return J({decimalPlaces:n},Math.pow(10,-n)*Number(e))}function G(t,e){return J({decimalPlaces:0},Math.pow(10,Number(t))*Number(e))}function J(t,e){var n=t.decimalPlaces,r=void 0===n?0:n;return Number(Math.round(Number(e+"e+".concat(r)))+"e-".concat(r))}function Y(t,e){return z.apply(this,arguments)}function z(){return(z=c(i().mark((function t(e,n){var r,s,a,o,u,c,p,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=[],s=N(n),t.prev=3,s.s();case 5:if((a=s.n()).done){t.next=18;break}return o=a.value,t.next=9,e.sendRawTransaction(o).do();case 9:return u=t.sent,c=u.txId,t.next=13,j(e,c);case 13:p=t.sent,l=p["confirmed-round"],r.push({confirmedRound:l,txnID:c});case 16:t.next=5;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(3),s.e(t.t0);case 23:return t.prev=23,s.f(),t.finish(23);case 26:return t.abrupt("return",r);case 29:throw t.prev=29,t.t1=t.catch(0),new k(t.t1,"We encountered an error while processing this transaction. Try again later.");case 32:case"end":return t.stop()}}),t,null,[[0,29],[3,20,23,26]])})))).apply(this,arguments)}function W(t){return t.reduce((function(t,e){return t+e.txn.fee}),0)}function Z(t){return(e=t[0].txn.group)?Buffer.from(e).toString("base64"):"";var e}function H(t){for(var e=[];;){var n=127&t;if(!(t>>=7)){e.push(n);break}e.push(128|n)}return e}function K(t){return(new TextEncoder).encode(t)}var $={id:"".concat(0),name:"Algorand",unit_name:"ALGO",decimals:6,url:"https://algorand.org",is_liquidity_token:!1,total_amount:"6615503326932151"},tt={V1:"TM1POOL",V1_1:"TMPOOL11",V2:"TMPOOL2"};function et(){return(et=c(i().mark((function t(e){var n,s,a,o,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,s=e.assetID,a=e.initiatorAddr,t.prev=1,t.next=4,n.getTransactionParams().do();case 4:return o=t.sent,u=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:a,to:a,assetIndex:s,amount:0,suggestedParams:o}),t.abrupt("return",[{txn:u,signers:[a]}]);case 9:throw t.prev=9,t.t0=t.catch(1),new k(t.t0,"We encountered something unexpected while opting into this asset. Try again later.");case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))).apply(this,arguments)}function nt(t,e){var n=Number(t.id),r=Number(e.id);return n>r?[o(o({},t),{},{id:n}),o(o({},e),{},{id:r})]:[o(o({},e),{},{id:r}),o(o({},t),{},{id:n})]}function rt(t,e){var n=[t,e];return[Math.max.apply(Math,n),Math.min.apply(Math,n)]}function st(t){return 0===Number(t)}var at,ot={V1_1:"v1_1",V2:"v2"},it={type:"logicsig",logic:{bytecode:"BCAIAQCBgICAgICAgPABgICAgICAgIDwAQMEBQYlJA1EMQkyAxJEMRUyAxJEMSAyAxJEMgQiDUQzAQAxABJEMwEQIQcSRDMBGIGCgICAgICAgPABEkQzARkiEjMBGyEEEhA3ARoAgAlib290c3RyYXASEEAAXDMBGSMSRDMBG4ECEjcBGgCABHN3YXASEEACOzMBGyISRDcBGgCABG1pbnQSQAE7NwEaAIAEYnVybhJAAZg3ARoAgAZyZWRlZW0SQAJbNwEaAIAEZmVlcxJAAnkAIQYhBSQjEk0yBBJENwEaARclEjcBGgIXJBIQRDMCADEAEkQzAhAhBBJEMwIhIxJEMwIiIxwSRDMCIyEHEkQzAiQjEkQzAiWACFRNUE9PTDExEkQzAiZRAA+AD1RpbnltYW5Qb29sMS4xIBJEMwIngBNodHRwczovL3RpbnltYW4ub3JnEkQzAikyAxJEMwIqMgMSRDMCKzIDEkQzAiwyAxJEMwMAMQASRDMDECEFEkQzAxElEkQzAxQxABJEMwMSIxJEJCMTQAAQMwEBMwIBCDMDAQg1AUIBsTMEADEAEkQzBBAhBRJEMwQRJBJEMwQUMQASRDMEEiMSRDMBATMCAQgzAwEIMwQBCDUBQgF8MgQhBhJENwEcATEAE0Q3ARwBMwQUEkQzAgAxABNEMwIUMQASRDMDADMCABJEMwIRJRJEMwMUMwMHMwMQIhJNMQASRDMDESMzAxAiEk0kEkQzBAAxABJEMwQUMwIAEkQzAQEzBAEINQFCAREyBCEGEkQ3ARwBMQATRDcBHAEzAhQSRDMDFDMDBzMDECISTTcBHAESRDMCADEAEkQzAhQzBAASRDMCESUSRDMDADEAEkQzAxQzAwczAxAiEk0zBAASRDMDESMzAxAiEk0kEkQzBAAxABNEMwQUMQASRDMBATMCAQgzAwEINQFCAJAyBCEFEkQ3ARwBMQATRDMCADcBHAESRDMCADEAE0QzAwAxABJEMwIUMwIHMwIQIhJNMQASRDMDFDMDBzMDECISTTMCABJEMwEBMwMBCDUBQgA+MgQhBBJENwEcATEAE0QzAhQzAgczAhAiEk03ARwBEkQzAQEzAgEINQFCABIyBCEEEkQzAQEzAgEINQFCAAAzAAAxABNEMwAHMQASRDMACDQBD0M=",address:"ABUKAXTANWR6K6ZYV75DWJEPVWWOU6SFUVRI6QHO44E4SIDLHBTD2CZ64A",size:881,variables:[{name:"TMPL_ASSET_ID_1",type:"int",index:15,length:10},{name:"TMPL_ASSET_ID_2",type:"int",index:5,length:10},{name:"TMPL_VALIDATOR_APP_ID",type:"int",index:74,length:10}],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/pool_logicsig.teal.tmpl"},name:"pool_logicsig"},ut={type:"app",approval_program:{bytecode:"BCAHAAHoB+UHBf///////////wHAhD0mDQFvAWUBcAJhMQJhMgJsdARzd2FwBG1pbnQBdAJjMQJwMQJjMgJwMjEZgQQSMRkhBBIRMRmBAhIRQATxMRkjEjEbIhIQQATjNhoAgAZjcmVhdGUSQATUMRkjEjYaAIAJYm9vdHN0cmFwEhBAA/MzAhIzAggINTQiK2I1ZSI0ZXAARDUBIicEYjVmNGZAABEiYCJ4CTEBCDMACAk1AkIACCI0ZnAARDUCIicFYjVnKDRlFlA1byI0b2I1PSg0ZhZQNXAiNHBiNT4oNGcWUDVxIjRxYjU/IipiNUA0ATQ9CTVHNAI0Pgk1SDEAKVA0ZRZQNXkxAClQNGYWUDV6MQApUDRnFlA1ezYaAIAGcmVkZWVtEkAAWjYaAIAEZmVlcxJAABw2GgAnBhI2GgAnBxIRNhoAgARidXJuEhFAAG0ANGdJRDMCERJEMwISRDMCFDIJEkQ0PzMCEgk1PzRAMwISCTVAIio0QGYiNHE0P2YjQzMCFDMCBzMCECMSTTYcARJENDREIigzAhEWUEpiNDQJZiMxAClQMwIRFlBKYjQ0CUlBAANmI0NIaCNDMgciJwhiCUk1+kEARiInCWIiJwpiNPodTEAANx4hBSMeHzX7SEhIIicLYiInDGI0+h1MQAAdHiEFIx4fNfxISEgiJwk0+2YiJws0/GYiJwgyB2YzAxIzAwgINTU2HAExABNENGdBACIiNGdwAEQ1BiIcNAYJND8INQQ2GgAnBhJAASA0ZzMEERJENhoAJwcSQABVNhwBMwQAEkQzBBI0Rx00BCMdH0hITEhJNRA0NAk1yTMEEjRIHTQEIx0fSEhMSEk1ETQ1CTXKNBA0ERBENEc0EAk1UTRINBEJNVI0BDMEEgk1U0ICCjYcATMCABJENEc0NAg1UTRINDUINVI0BCISQAAuNDQ0BB00RyMdH0hITEg0NTQEHTRIIx0fSEhMSEoNTUk0BAg1UzMEEgk1y0IBvyInBTMEEUk1Z2YoNGcWUDVxIjRncABERDRnNGUTRDRnNGYTRDMEEiQISR018DQ0NDUdNfFKDEAACBJENPA08Q5EMwQSJAgjCEkdNfA0NDQ1HTXxSg1AAAgSRDTwNPENRCQ1PzQEMwQSJAgINVNCAU82HAEzAgASRDMCETRlEjMDETRmEhBJNWRAABkzAhE0ZhIzAxE0ZRIQRDRINRI0RzUTQgAINEc1EjRINRM2GgGAAmZpEkAAWjYaAYACZm8SRDQ1JAs0Eh00EzQ1CSUdH0hITEgjCEk1FSINNDU0EwwQRDQ0NBUJNGRBABM1yTRHNBUINVE0SDQ1CTVSQgBnNco0SDQVCDVSNEc0NQk1UUIAVDQ0STUVJQs0Ex00EiQLNDQlCx4fSEhMSEk1FCINNBQ0EwwQRDQUNDUJNGRBABM1yjRHNDQINVE0SDQUCTVSQgATNck0RzQUCTVRNEg0NAg1UkIAADQVIQQLNAQdgaCcATQSHR9ISExISTUqNAQINVNCADsiKzYaARdJNWVmIicENhoCF0k1ZmY0ZXEDRIABLVCABEFMR080ZkEABkg0ZnEDRFAzAiZJFYEPTFISQyIqNEA0KghmIjRxND80Kgg0ywhmIjRvND00yQhmIjRwND40yghmIoACczE0UWYigAJzMjRSZiInCjRSIQYdNFEjHR9ISExIZiInDDRRIQYdNFIjHR9ISExIZiKAA2lsdDRTZjTLQQAJIzR7SmI0ywhmNMlBAAkjNHlKYjTJCGY0ykEACSM0ekpiNMoIZiNDI0MiQw==",address:"BUQHXHPLMYUVS3P2INJ2EUJFCSNT6LNUGXVM6T2SZ27TDRDYLUMWCFYW3E",size:1351,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_approval.teal"},clear_program:{bytecode:"BIEB",address:"P7GEWDXXW5IONRW6XRIRVPJCT2XXEQGOBGG65VJPBUOYZEJCBZWTPHS3VQ",size:3,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_clear_state.teal"},global_state_schema:{num_uints:0,num_byte_slices:0},local_state_schema:{num_uints:16,num_byte_slices:0},name:"validator_app"},ct=(f(at={},ot.V1_1,{testnet:62368684,mainnet:552635992}),f(at,ot.V2,{testnet:113134165,mainnet:552635992}),at);function pt(t,e){var n=ct[e][t];if(!n)throw new Error("No Validator App exists for ".concat(t," network with ").concat(e," contract version"));return n}function lt(){return(lt=c(i().mark((function t(e){var n,s,a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,s=e.network,a=e.contractVersion,o=e.initiatorAddr,t.next=3,n.getTransactionParams().do();case 3:return u=t.sent,c=r.default.makeApplicationOptInTxnFromObject({from:o,appIndex:pt(s,a),suggestedParams:u}),t.abrupt("return",[{txn:c,signers:[o]}]);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(){return(dt=c(i().mark((function t(e){var n,s,a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,s=e.network,a=e.contractVersion,o=e.initiatorAddr,t.next=3,n.getTransactionParams().do();case 3:return u=t.sent,c=r.default.makeApplicationClearStateTxnFromObject({from:o,appIndex:pt(s,a),suggestedParams:u}),t.abrupt("return",[{txn:c,signers:[o]}]);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ft=d((function t(n){p(this,t),this.validatorApprovalContract=e.toByteArray(n.approval_program.bytecode),this.validatorClearStateContract=e.toByteArray(n.clear_program.bytecode),this.schema={numLocalInts:n.local_state_schema.num_uints,numLocalByteSlices:n.local_state_schema.num_byte_slices,numGlobalInts:n.global_state_schema.num_uints,numGlobalByteSlices:n.global_state_schema.num_byte_slices}})),It=new(function(n){I(s,ft);var r=y(s);function s(t,e){var n;return p(this,s),(n=r.call(this,t)).poolLogicSigContractTemplate=e.logic.bytecode,n.templateVariables=e.logic.variables,n}return d(s,[{key:"generateLogicSigAccountForPool",value:function(n){if(n.asset1ID===n.asset2ID)throw new Error("Assets are the same");var r=pt(n.network,ot.V1_1),s=E(rt(n.asset1ID,n.asset2ID),2),a=s[0],o=s[1],i=Array.from(e.toByteArray(this.poolLogicSigContractTemplate)),u={asset_id_1:a,asset_id_2:o,validator_app_id:r},c=0;this.templateVariables.sort((function(t,e){return t.index-e.index}));for(var p=0;p<this.templateVariables.length;p++){var l=this.templateVariables[p],d=u[l.name.split("TMPL_")[1].toLowerCase()],f=l.index-c,I=f+l.length,A=H(d);c+=l.length-A.length,i=i.slice(0,f).concat(A).concat(i.slice(I))}var m=new Uint8Array(i);return new t.LogicSigAccount(m)}}]),s}())(ut,it),At={type:"logicsig",logic:{bytecode:"BoAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgQBbNQA0ADEYEkQxGYEBEkSBAUM="},name:"pool_logicsig"},mt={type:"app",approval_program:{bytecode:"BCAHAAHoB+UHBf///////////wHAhD0mDQFvAWUBcAJhMQJhMgJsdARzd2FwBG1pbnQBdAJjMQJwMQJjMgJwMjEZgQQSMRkhBBIRMRmBAhIRQATxMRkjEjEbIhIQQATjNhoAgAZjcmVhdGUSQATUMRkjEjYaAIAJYm9vdHN0cmFwEhBAA/MzAhIzAggINTQiK2I1ZSI0ZXAARDUBIicEYjVmNGZAABEiYCJ4CTEBCDMACAk1AkIACCI0ZnAARDUCIicFYjVnKDRlFlA1byI0b2I1PSg0ZhZQNXAiNHBiNT4oNGcWUDVxIjRxYjU/IipiNUA0ATQ9CTVHNAI0Pgk1SDEAKVA0ZRZQNXkxAClQNGYWUDV6MQApUDRnFlA1ezYaAIAGcmVkZWVtEkAAWjYaAIAEZmVlcxJAABw2GgAnBhI2GgAnBxIRNhoAgARidXJuEhFAAG0ANGdJRDMCERJEMwISRDMCFDIJEkQ0PzMCEgk1PzRAMwISCTVAIio0QGYiNHE0P2YjQzMCFDMCBzMCECMSTTYcARJENDREIigzAhEWUEpiNDQJZiMxAClQMwIRFlBKYjQ0CUlBAANmI0NIaCNDMgciJwhiCUk1+kEARiInCWIiJwpiNPodTEAANx4hBSMeHzX7SEhIIicLYiInDGI0+h1MQAAdHiEFIx4fNfxISEgiJwk0+2YiJws0/GYiJwgyB2YzAxIzAwgINTU2HAExABNENGdBACIiNGdwAEQ1BiIcNAYJND8INQQ2GgAnBhJAASA0ZzMEERJENhoAJwcSQABVNhwBMwQAEkQzBBI0Rx00BCMdH0hITEhJNRA0NAk1yTMEEjRIHTQEIx0fSEhMSEk1ETQ1CTXKNBA0ERBENEc0EAk1UTRINBEJNVI0BDMEEgk1U0ICCjYcATMCABJENEc0NAg1UTRINDUINVI0BCISQAAuNDQ0BB00RyMdH0hITEg0NTQEHTRIIx0fSEhMSEoNTUk0BAg1UzMEEgk1y0IBvyInBTMEEUk1Z2YoNGcWUDVxIjRncABERDRnNGUTRDRnNGYTRDMEEiQISR018DQ0NDUdNfFKDEAACBJENPA08Q5EMwQSJAgjCEkdNfA0NDQ1HTXxSg1AAAgSRDTwNPENRCQ1PzQEMwQSJAgINVNCAU82HAEzAgASRDMCETRlEjMDETRmEhBJNWRAABkzAhE0ZhIzAxE0ZRIQRDRINRI0RzUTQgAINEc1EjRINRM2GgGAAmZpEkAAWjYaAYACZm8SRDQ1JAs0Eh00EzQ1CSUdH0hITEgjCEk1FSINNDU0EwwQRDQ0NBUJNGRBABM1yTRHNBUINVE0SDQ1CTVSQgBnNco0SDQVCDVSNEc0NQk1UUIAVDQ0STUVJQs0Ex00EiQLNDQlCx4fSEhMSEk1FCINNBQ0EwwQRDQUNDUJNGRBABM1yjRHNDQINVE0SDQUCTVSQgATNck0RzQUCTVRNEg0NAg1UkIAADQVIQQLNAQdgaCcATQSHR9ISExISTUqNAQINVNCADsiKzYaARdJNWVmIicENhoCF0k1ZmY0ZXEDRIABLVCABEFMR080ZkEABkg0ZnEDRFAzAiZJFYEPTFISQyIqNEA0KghmIjRxND80Kgg0ywhmIjRvND00yQhmIjRwND40yghmIoACczE0UWYigAJzMjRSZiInCjRSIQYdNFEjHR9ISExIZiInDDRRIQYdNFIjHR9ISExIZiKAA2lsdDRTZjTLQQAJIzR7SmI0ywhmNMlBAAkjNHlKYjTJCGY0ykEACSM0ekpiNMoIZiNDI0MiQw==",address:"BUQHXHPLMYUVS3P2INJ2EUJFCSNT6LNUGXVM6T2SZ27TDRDYLUMWCFYW3E",size:1351,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_approval.teal"},clear_program:{bytecode:"BIEB",address:"P7GEWDXXW5IONRW6XRIRVPJCT2XXEQGOBGG65VJPBUOYZEJCBZWTPHS3VQ",size:3,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_clear_state.teal"},global_state_schema:{num_uints:0,num_byte_slices:3},local_state_schema:{num_uints:12,num_byte_slices:2},name:"validator_app"},gt=new(function(e){I(r,ft);var n=y(r);function r(t,e){var s;return p(this,r),(s=n.call(this,t)).poolLogicSigContractTemplate=e.logic.bytecode,s}return d(r,[{key:"generateLogicSigAccountForPool",value:function(e){if(e.asset1ID===e.asset2ID)throw new Error("Assets are the same");var n=pt(e.network,ot.V2),r=E(rt(e.asset1ID,e.asset2ID),2),s=r[0],a=r[1],o={bytes:Array.from(Buffer.from(this.poolLogicSigContractTemplate,"base64")),validatorAppId:Array.from(t.encodeUint64(n)),asset1ID:Array.from(t.encodeUint64(s)),asset2ID:Array.from(t.encodeUint64(a))},i=[].concat(D(o.bytes.slice(0,3)),D(o.validatorAppId.slice(0,8)),D(o.asset1ID.slice(0,8)),D(o.asset2ID.slice(0,8)),D(o.bytes.slice(27)));return new t.LogicSigAccount(new Uint8Array(i))}}]),r}())(mt,At);function xt(t){return function(t){return t===ot.V2}(t)?gt:It}function Tt(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.IntDecoding.DEFAULT;return new Promise(function(){var t=c(i().mark((function t(s,a){var u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.accountInformation(n).setIntDecoding(r).do();case 3:u=t.sent,s(o(o({},u),{},{minimum_required_balance:yt(u)})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a(new Error(t.t0.message||"Failed to fetch account information"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())}function ht(t,e){var n=t["apps-local-state"].find((function(t){return t.id===e}));return n?R({stateArray:n["key-value"],shouldDecodeKeys:!0}):null}function yt(t){var e=t["apps-total-schema"];return 1e5+1e5*(t.assets||[]).length+1e5*(t["created-apps"]||[]).length+1e5*(t["apps-local-state"]||[]).length+5e4*Number(e&&e["num-byte-slice"]||0)+28500*Number(e&&e["num-uint"]||0)+1e5*(t["apps-total-extra-pages"]||0)}var Et,Dt,vt=K("e");function _t(t){return Nt.apply(this,arguments)}function Nt(){return(Nt=c(i().mark((function n(s){var a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,E,D,v,_,w;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=s.client,o=s.pool,u=s.accountAddr,n.next=3,a.accountInformation(u).setIntDecoding(t.IntDecoding.BIGINT).do();case 3:c=n.sent,p=c["apps-local-state"]||[],l=0n,d=0n,f=0n,I=o.account.address(),A=N(p),n.prev=10,A.s();case 12:if((m=A.n()).done){n.next=31;break}if((g=m.value).id==o.validatorAppID){n.next=16;break}return n.abrupt("continue",29);case 16:if(x=g["key-value"]){n.next=19;break}return n.abrupt("break",31);case 19:T=R({stateArray:x}),h=e.fromByteArray(O([r.default.decodeAddress(I).publicKey,vt,r.default.encodeUint64(o.asset1ID)])),y=e.fromByteArray(O([r.default.decodeAddress(I).publicKey,vt,r.default.encodeUint64(o.asset2ID)])),E=e.fromByteArray(O([r.default.decodeAddress(I).publicKey,vt,r.default.encodeUint64(o.liquidityTokenID)])),D=T[h],v=T[y],_=T[E],"bigint"==typeof D&&(l=D),"bigint"==typeof v&&(d=v),"bigint"==typeof _&&(f=_);case 29:n.next=12;break;case 31:n.next=36;break;case 33:n.prev=33,n.t0=n.catch(10),A.e(n.t0);case 36:return n.prev=36,A.f(),n.finish(36);case 39:if(!((w={excessAsset1:l,excessAsset2:d,excessLiquidityTokens:f}).excessAsset1<0n||w.excessAsset2<0n||w.excessLiquidityTokens<0n)){n.next=42;break}throw new Error("Invalid account excess: ".concat(w));case 42:return n.abrupt("return",w);case 43:case"end":return n.stop()}}),n,null,[[10,33,36,39]])})))).apply(this,arguments)}function wt(){return(wt=c(i().mark((function t(n){var s,a,o,u,c,p,l,d,f,I,A,m,g,x,T;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.client,a=n.accountAddr,o=n.validatorAppID,t.next=3,s.accountInformation(a).setIntDecoding("bigint").do();case 3:if(u=t.sent,c=u["apps-local-state"]||[],p=c.find((function(t){return t.id==o})),l=[],p&&p["key-value"])for(d=R({stateArray:p["key-value"]}),f=0,I=Object.entries(d);f<I.length;f++)A=I[f],m=E(A,2),g=m[0],x=m[1],41===(T=e.toByteArray(g)).length&&101===T[32]&&l.push({poolAddress:r.default.encodeAddress(T.slice(0,32)),assetID:r.default.decodeUint64(T.slice(33,41),"safe"),amount:parseInt(x)});return t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}exports.PoolStatus=void 0,(Et=exports.PoolStatus||(exports.PoolStatus={})).NOT_CREATED="not created",Et.BOOTSTRAP="bootstrap",Et.READY="ready",Et.ERROR="error";var St=(f(Dt={},ot.V1_1,{asset1:"a1",asset2:"a2"}),f(Dt,ot.V2,{asset1:"asset_1_id",asset2:"asset_2_id",liquidityTokenID:"pool_token_asset_id",issuedPoolTokens:"issued_pool_tokens",asset1Reserves:"asset_1_reserves",asset2Reserves:"asset_2_reserves",asset1ProtocolFees:"asset_1_protocol_fees",asset2ProtocolFees:"asset_2_protocol_fees",totalFeeShare:"total_fee_share",protocolFeeRatio:"protocol_fee_ratio",cumulativePriceUpdateTimeStamp:"cumulative_price_update_timestamp"}),Dt),bt=K("o"),Pt=0xffffffffffffffffn;function kt(t){return Rt.apply(this,arguments)}function Rt(){return(Rt=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d,f,I,A,m;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.client,s=e.network,a=e.asset1ID,o=e.asset2ID,u=xt(ot.V1_1),c=u.generateLogicSigAccountForPool(e),p=pt(s,ot.V1_1),l=c.address(),d=rt(a,o),t.next=8,Tt(r,l);case 8:return f=t.sent,I=ht(f,p),A=null===(n=f["created-assets"][0])||void 0===n?void 0:n.index,m={account:c,validatorAppID:p,asset1ID:d[0],asset2ID:d[1],status:I||A?exports.PoolStatus.READY:exports.PoolStatus.NOT_CREATED,contractVersion:ot.V1_1,liquidityTokenID:A},I&&(m.asset1ID=I[St.v1_1.asset1],m.asset2ID=I[St.v1_1.asset2]),t.abrupt("return",m);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ot(){return(Ot=c(i().mark((function n(s,a){var o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,E,D,v,_,w,S,b,P,k,B,M;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Tt(s,a.account.address(),t.IntDecoding.BIGINT);case 2:o=n.sent,u=o["apps-local-state"]||[],c=0n,p=0n,l=0n,d=N(u),n.prev=8,d.s();case 10:if((f=d.n()).done){n.next=29;break}if((I=f.value).id==a.validatorAppID){n.next=14;break}return n.abrupt("continue",27);case 14:if(A=I["key-value"]){n.next=17;break}return n.abrupt("break",29);case 17:m=R({stateArray:A}),g=e.fromByteArray(O([bt,r.default.encodeUint64(a.asset1ID)])),x=e.fromByteArray(O([bt,r.default.encodeUint64(a.asset2ID)])),T=e.fromByteArray(O([bt,r.default.encodeUint64(a.liquidityTokenID)])),h=m[g],y=m[x],E=m[T],"bigint"==typeof h&&(c=h),"bigint"==typeof y&&(p=y),"bigint"==typeof E&&(l=E);case 27:n.next=10;break;case 29:n.next=34;break;case 31:n.prev=31,n.t0=n.catch(8),d.e(n.t0);case 34:return n.prev=34,d.f(),n.finish(34);case 37:D=0n,v=0n,_=0n,w=N(o.assets);try{for(w.s();!(S=w.n()).done;)b=S.value,P=b["asset-id"],k=b.amount,P==a.asset1ID?D=BigInt(k):P==a.asset2ID?v=BigInt(k):P==a.liquidityTokenID&&(_=BigInt(k))}catch(t){w.e(t)}finally{w.f()}if(0===a.asset2ID&&(B=C(o),v=BigInt(o.amount)-B),!((M={asset1:D-c,asset2:v-p,issuedLiquidity:Pt-_+l,round:o.round}).asset1<0n||M.asset2<0n||M.issuedLiquidity<0n||M.issuedLiquidity>Pt)){n.next=49;break}throw M.asset1=Number(M.asset1),M.asset2=Number(M.asset2),M.issuedLiquidity=Number(M.issuedLiquidity),new Error("Invalid pool reserves: ".concat(JSON.stringify(M)));case 49:return n.abrupt("return",M);case 50:case"end":return n.stop()}}),n,null,[[8,31,34,37]])})))).apply(this,arguments)}function Bt(){return Bt=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.client,r=e.address,s=e.network,!(a=d.length>1&&void 0!==d[1]?d[1]:{})[r]){t.next=4;break}return t.abrupt("return",a[r]);case 4:return t.next=6,Tt(n,r);case 6:return o=t.sent,u=ht(o,pt(s,ot.V1_1)),c=null,u&&(l=o["created-assets"][0],p=l.index,c={asset1ID:u[St[ot.V1_1].asset1],asset2ID:u[St[ot.V1_1].asset2],liquidityTokenID:p},a[r]=c),t.abrupt("return",c);case 11:case"end":return t.stop()}}),t)}))),Bt.apply(this,arguments)}var Mt=Object.freeze({__proto__:null,getPoolInfo:kt,getPoolReserves:function(t,e){return Ot.apply(this,arguments)},getPoolAssets:function(t){return Bt.apply(this,arguments)}});function Qt(t){return Lt.apply(this,arguments)}function Lt(){return(Lt=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d,f,I;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.network,s=e.asset1ID,a=e.asset2ID,o=xt(ot.V2),u=o.generateLogicSigAccountForPool(e),c=pt(r,ot.V2),p=u.address(),l=rt(s,a),t.next=8,Tt(n,p);case 8:return d=t.sent,f=ht(d,c),I={account:u,validatorAppID:c,asset1ID:l[0],asset2ID:l[1],status:f?exports.PoolStatus.READY:exports.PoolStatus.NOT_CREATED,contractVersion:ot.V2},f&&(I.asset1ProtocolFees=BigInt(f[St.v2.asset1ProtocolFees]),I.asset2ProtocolFees=BigInt(f[St.v2.asset2ProtocolFees]),I.asset1Reserves=BigInt(f[St.v2.asset1Reserves]),I.asset2Reserves=BigInt(f[St.v2.asset2Reserves]),I.issuedPoolTokens=BigInt(f[St.v2.issuedPoolTokens]),I.cumulativePriceUpdateTimeStamp=Number(f[St.v2.cumulativePriceUpdateTimeStamp]),I.protocolFeeRatio=Number(f[St.v2.protocolFeeRatio]),I.totalFeeShare=BigInt(f[St.v2.totalFeeShare]),I.liquidityTokenID=Number(f[St.v2.liquidityTokenID]),I.asset1ID=Number(f[St.v2.asset1]),I.asset2ID=Number(f[St.v2.asset2])),t.abrupt("return",I);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ft(){return(Ft=c(i().mark((function t(e,n){var r,s,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Tt(e,n.account.address());case 2:return r=t.sent,s=ht(r,n.validatorAppID),a={asset1:0n,asset2:0n,issuedLiquidity:0n,round:r.round},s&&(a.asset1=BigInt(s[St.v2.asset1Reserves]),a.asset2=BigInt(s[St.v2.asset2Reserves]),a.issuedLiquidity=BigInt(s[St.v2.issuedPoolTokens])),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ct(){return(Ct=c(i().mark((function t(e){var n,r,s,a,o,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.address,s=e.network,t.next=3,Tt(n,r);case 3:return a=t.sent,o=ht(a,pt(s,ot.V2)),u=null,o&&(u={asset1ID:o[St[ot.V2].asset1],asset2ID:o[St[ot.V2].asset2],liquidityTokenID:o[St[ot.V2].liquidityTokenID]}),t.abrupt("return",u);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ut=Object.freeze({__proto__:null,getPoolInfo:Qt,getPoolReserves:function(t,e){return Ft.apply(this,arguments)},getPoolAssets:function(t){return Ct.apply(this,arguments)}});function jt(t){return Boolean(t&&!(t.asset1+t.asset2))}var Vt,Xt,qt=Object.freeze({__proto__:null,getPoolShare:function(t,e){var n=Number(e)/Number(t);return Number.isFinite(n)||(n=0),n},getPoolPairRatio:function(t,e){var n=jt(e),r=null;return e&&!n&&e.asset1&&e.asset2&&"number"==typeof t.asset2&&"number"==typeof t.asset1&&(r=q(t.asset1,e.asset1)/q(t.asset2,e.asset2)),r},isPoolEmpty:jt,isPoolNotCreated:function(t){return(null==t?void 0:t.status)===exports.PoolStatus.NOT_CREATED},isPoolReady:function(t){return(null==t?void 0:t.status)===exports.PoolStatus.READY},getPoolsForPair:function(t){return Promise.all([kt(t),Qt(t)])}}),Gt=o((f(Vt={},ot.V1_1,o(o({},Mt),qt)),f(Vt,ot.V2,o(o({},Ut),qt)),Vt),qt);!function(t){t[t.FUNDING_TXN=0]="FUNDING_TXN",t[t.VALIDATOR_APP_CALL=1]="VALIDATOR_APP_CALL",t[t.LIQUIDITY_TOKEN_CREATE=2]="LIQUIDITY_TOKEN_CREATE",t[t.ASSET1_OPT_IN=3]="ASSET1_OPT_IN",t[t.ASSET2_OPT_IN=4]="ASSET2_OPT_IN"}(Xt||(Xt={}));var Jt=96e4,Yt=859e3;function zt(){return(zt=c(i().mark((function t(e){var n,s,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,D,v,_,N,w,S,b;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,s=e.network,a=e.asset_1,o=e.asset_2,u=e.initiatorAddr,t.next=3,n.getTransactionParams().do();case 3:return c=t.sent,p=nt(a,o),l=E(p,2),d=l[0],f=d.id,I=d.unit_name,A=l[1],m=A.id,g=A.unit_name,x=st(m),T=pt(s,ot.V1_1),h=It.generateLogicSigAccountForPool({network:s,asset1ID:f,asset2ID:m}),y=h.address(),D=r.default.makeApplicationOptInTxnFromObject({from:y,appIndex:T,appArgs:[K("bootstrap"),r.default.encodeUint64(f),r.default.encodeUint64(m)],foreignAssets:x?[f]:[m],suggestedParams:c}),v=r.default.makeAssetCreateTxnWithSuggestedParamsFromObject({from:y,total:0xffffffffffffffffn,decimals:6,defaultFrozen:!1,unitName:tt.V1_1,assetName:"TinymanPool1.1 ".concat(I,"-").concat(g),assetURL:"https://tinyman.org",suggestedParams:c}),_=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:y,to:y,assetIndex:f,amount:0,suggestedParams:c}),N=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:u,to:y,amount:Wt(x),suggestedParams:c}),(w=[])[Xt.FUNDING_TXN]=N,w[Xt.VALIDATOR_APP_CALL]=D,w[Xt.LIQUIDITY_TOKEN_CREATE]=v,w[Xt.ASSET1_OPT_IN]=_,x||(w[Xt.ASSET2_OPT_IN]=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:y,to:y,assetIndex:m,amount:0,suggestedParams:c})),S=r.default.assignGroupID(w),b=[{txn:S[Xt.FUNDING_TXN],signers:[u]},{txn:S[Xt.VALIDATOR_APP_CALL],signers:[y]},{txn:S[Xt.LIQUIDITY_TOKEN_CREATE],signers:[y]},{txn:S[Xt.ASSET1_OPT_IN],signers:[y]}],S[Xt.ASSET2_OPT_IN]&&b.push({txn:S[Xt.ASSET2_OPT_IN],signers:[y]}),t.abrupt("return",b);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wt(t){return t?Jt:Yt}function Zt(){return(Zt=c(i().mark((function t(e){var n,s,a,o,u,c,p,l,d,f,I,A,m,g,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.txGroup,s=e.network,a=e.initiatorSigner,o=e.asset1ID,u=e.asset2ID,t.next=3,a([n]);case 3:return c=t.sent,p=E(c,1),l=p[0],d=rt(o,u),f=E(d,2),I=f[0],A=f[1],m=It.generateLogicSigAccountForPool({network:s,asset1ID:I,asset2ID:A}),g=[],x=n.map((function(t,e){if(e===Xt.FUNDING_TXN)return g.push(t.txn.txID().toString()),l;var n=r.default.signLogicSigTransactionObject(t.txn,m),s=n.txID,a=n.blob;return g.push(s),a})),t.abrupt("return",{signedTxns:x,txnIDs:g});case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ht(t){return Kt.apply(this,arguments)}function Kt(){return(Kt=c(i().mark((function t(e){var n,r,s,a,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.signedTxns,s=e.txnIDs,t.prev=1,t.next=4,n.sendRawTransaction(r).do();case 4:return t.next=6,j(n,s[Xt.LIQUIDITY_TOKEN_CREATE]);case 6:if(a=t.sent,"number"==typeof(o=a["asset-index"])){t.next=10;break}throw new Error("Generated ID is not valid: got ".concat(o));case 10:return t.abrupt("return",{liquidityTokenID:o});case 13:throw t.prev=13,t.t0=t.catch(1),new k(t.t0,"We encountered something unexpected while bootstraping the pool. Try again later.");case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}function $t(){return($t=c(i().mark((function t(e){var n,r,s,a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.network,s=e.pool,a=s.asset1ID,o=s.asset2ID,u=e.signedTxns,c=e.txnIDs,t.next=3,Ht({client:n,signedTxns:u,txnIDs:c});case 3:return t.abrupt("return",Gt.v1_1.getPoolInfo({client:n,network:r,asset1ID:a,asset2ID:o}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var te,ee={generateTxns:function(t){return zt.apply(this,arguments)},signTxns:function(t){return Zt.apply(this,arguments)},execute:function(t){return $t.apply(this,arguments)},getBootstrapFundingTxnAmount:Wt};!function(t){t[t.FUNDING_TXN=0]="FUNDING_TXN",t[t.VALIDATOR_APP_CALL=1]="VALIDATOR_APP_CALL"}(te||(te={}));var ne=5,re=6;function se(){return(se=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,D,v,_;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.network,o=n.asset_1,u=n.asset_2,c=n.initiatorAddr,e.next=3,s.getTransactionParams().do();case 3:return p=e.sent,l=pt(a,ot.V2),d=t.getApplicationAddress(l),f=nt(o,u),I=E(f,2),A=I[0].id,m=I[1].id,e.next=9,Gt.v2.getPoolInfo({client:s,network:a,asset1ID:A,asset2ID:m});case 9:if(e.sent.status!==exports.PoolStatus.READY){e.next=12;break}throw new Error("Pool for ".concat(o.unit_name,"-").concat(u.unit_name," already exists"));case 12:return g=gt.generateLogicSigAccountForPool({network:a,asset1ID:A,asset2ID:m}),x=g.address(),T=st(m),(h=r.default.makeApplicationOptInTxnFromObject({from:x,appIndex:l,appArgs:[K("bootstrap")],foreignAssets:[A,m],rekeyTo:d,suggestedParams:p})).fee=oe(T),y=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:c,to:x,amount:ae(T),suggestedParams:p}),(D=[])[te.FUNDING_TXN]=y,D[te.VALIDATOR_APP_CALL]=h,v=r.default.assignGroupID(D),(_=[])[te.FUNDING_TXN]={txn:v[te.FUNDING_TXN],signers:[c]},_[te.VALIDATOR_APP_CALL]={txn:v[te.VALIDATOR_APP_CALL],signers:[x]},e.abrupt("return",_);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(t){return function(t,e){var n=xt(t).schema,r=4e5+28500*n.numLocalInts+5e4*n.numLocalByteSlices;return e||(r+=1e5),r}(ot.V2,t)+oe(t)+1e5}function oe(e){return((e?ne:re)+1)*t.ALGORAND_MIN_TX_FEE}function ie(){return(ie=c(i().mark((function t(e){var n,s,a,o,u,c,p,l,d,f,I,A,m,g,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.txGroup,s=e.network,a=e.initiatorSigner,o=e.asset1ID,u=e.asset2ID,t.next=3,a([n]);case 3:return c=t.sent,p=E(c,1),l=p[0],d=rt(o,u),f=E(d,2),I=f[0],A=f[1],m=gt.generateLogicSigAccountForPool({network:s,asset1ID:I,asset2ID:A}),g=[],x=n.map((function(t,e){if(e===te.FUNDING_TXN)return g.push(t.txn.txID().toString()),l;var n=r.default.signLogicSigTransactionObject(t.txn,m),s=n.txID,a=n.blob;return g.push(s),a})),t.abrupt("return",{signedTxns:x,txnIDs:g});case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ue(t){return ce.apply(this,arguments)}function ce(){return(ce=c(i().mark((function t(e){var n,r,s,a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.signedTxns,s=e.txnIDs,t.prev=1,t.next=4,n.sendRawTransaction(r).do();case 4:return t.next=6,j(n,s[te.VALIDATOR_APP_CALL]);case 6:if(u=t.sent,"number"==typeof(c=null===(a=u["local-state-delta"][0].delta)||void 0===a||null===(o=a.find((function(t){return t.key===btoa(St.v2.liquidityTokenID)})))||void 0===o?void 0:o.value.uint)){t.next=10;break}throw new Error("Generated ID is not valid: got ".concat(c));case 10:return t.abrupt("return",{liquidityTokenID:c});case 13:throw t.prev=13,t.t0=t.catch(1),new k(t.t0,"We encountered something unexpected while bootstraping the pool. Try again later.");case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}function pe(){return(pe=c(i().mark((function t(e){var n,r,s,a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.network,s=e.pool,a=s.asset1ID,o=s.asset2ID,u=e.signedTxns,c=e.txnIDs,t.next=3,ue({client:n,signedTxns:u,txnIDs:c});case 3:return t.abrupt("return",Gt.v2.getPoolInfo({client:n,network:r,asset1ID:a,asset2ID:o}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var le,de={generateTxns:function(t){return se.apply(this,arguments)},signTxns:function(t){return ie.apply(this,arguments)},execute:function(t){return pe.apply(this,arguments)},getBootstrapFundingTxnAmount:ae};var fe,Ie=(f(le={},ot.V1_1,ee),f(le,ot.V2,de),f(le,"generateTxns",(function(t){return t.contractVersion===ot.V1_1?ee.generateTxns(t):de.generateTxns(t)})),f(le,"signTxns",(function(t){return t.contractVersion===ot.V1_1?ee.signTxns(t):de.signTxns(t)})),f(le,"execute",(function(t){return t.contractVersion===ot.V1_1?ee.execute(t):de.execute(t)})),f(le,"calculateBootstrapFundingTxnAmount",(function(t){var e=t.contractVersion,n=t.isAlgoPool;return e===ot.V1_1?ee.getBootstrapFundingTxnAmount(n):de.getBootstrapFundingTxnAmount(n)})),le);exports.V1_1AddLiquidityTxnIndices=void 0,(fe=exports.V1_1AddLiquidityTxnIndices||(exports.V1_1AddLiquidityTxnIndices={}))[fe.FEE_TXN=0]="FEE_TXN",fe[fe.VALIDATOR_APP_CALL_TXN=1]="VALIDATOR_APP_CALL_TXN",fe[fe.ASSET1_IN_TXN=2]="ASSET1_IN_TXN",fe[fe.ASSET2_IN_TXN=3]="ASSET2_IN_TXN",fe[fe.LIQUDITY_OUT_TXN=4]="LIQUDITY_OUT_TXN";var Ae,me;exports.V2AddLiquidityType=void 0,(me=exports.V2AddLiquidityType||(exports.V2AddLiquidityType={})).SINGLE="single",me.FLEXIBLE="flexible",me.INITIAL="initial";var ge,xe=(f(Ae={},exports.V2AddLiquidityType.FLEXIBLE,{ASSET1_IN_TXN:0,ASSET2_IN_TXN:1,VALIDATOR_APP_CALL_TXN:2}),f(Ae,exports.V2AddLiquidityType.SINGLE,{ASSET_IN_TXN:0,VALIDATOR_APP_CALL_TXN:1}),f(Ae,exports.V2AddLiquidityType.INITIAL,{ASSET1_IN_TXN:0,ASSET2_IN_TXN:1,VALIDATOR_APP_CALL_TXN:2}),Ae),Te=1,he=2,ye=2,Ee=K("add_liquidity"),De=(f(ge={},ot.V1_1,[K("mint")]),f(ge,ot.V2,{INITIAL_LIQUIDITY:[K("add_initial_liquidity")],SINGLE_ASSET_MODE:[Ee,K("single")],FLEXIBLE_MODE:[Ee,K("flexible")]}),ge);function ve(){return(ve=c(i().mark((function t(e){var n,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,a=e.network,o=e.poolAddress,u=e.asset_1,c=e.asset_2,p=e.liquidityToken,l=e.slippage,d=e.initiatorAddr,f=X("negative",l,p.amount),t.next=4,n.getTransactionParams().do();case 4:return I=t.sent,A=r.default.makeApplicationNoOpTxnFromObject({from:o,appIndex:pt(a,ot.V1_1),appArgs:De.v1_1,accounts:[d],foreignAssets:0==c.id?[u.id,p.id]:[u.id,c.id,p.id],suggestedParams:I}),m=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:o,assetIndex:u.id,amount:u.amount,suggestedParams:I}),g=0===c.id?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:o,amount:c.amount,suggestedParams:I}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:o,assetIndex:c.id,amount:c.amount,suggestedParams:I}),x=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:o,to:d,assetIndex:p.id,amount:f,suggestedParams:I}),T=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:o,amount:A.fee+x.fee,note:s,suggestedParams:I}),h=r.default.assignGroupID([T,A,m,g,x]),t.abrupt("return",[{txn:h[0],signers:[d]},{txn:h[1],signers:[o]},{txn:h[2],signers:[d]},{txn:h[3],signers:[d]},{txn:h[4],signers:[o]}]);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _e(){return(_e=c(i().mark((function t(e){var n,s,a,o,u,c,p,l,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.pool,s=e.txGroup,a=e.initiatorSigner,o=n.account,t.next=4,a([s]);case 4:return u=t.sent,c=E(u,3),p=c[0],l=c[1],d=c[2],f=s.map((function(t,e){return e===exports.V1_1AddLiquidityTxnIndices.FEE_TXN?p:e===exports.V1_1AddLiquidityTxnIndices.ASSET1_IN_TXN?l:e===exports.V1_1AddLiquidityTxnIndices.ASSET2_IN_TXN?d:r.default.signLogicSigTransactionObject(t.txn,o).blob})),t.abrupt("return",f);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ne(){return(Ne=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d,f,I,A,m,g,x,T;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.pool,s=e.txGroup,a=e.signedTxns,o=e.initiatorAddr,t.prev=1,u=BigInt(s[exports.V1_1AddLiquidityTxnIndices.LIQUDITY_OUT_TXN].txn.amount),t.next=5,_t({client:n,pool:r,accountAddr:o});case 5:return c=t.sent,t.next=8,Y(n,[a]);case 8:return p=t.sent,l=E(p,1),d=l[0],f=d.confirmedRound,I=d.txnID,A=W(s),m=Z(s),t.next=17,_t({client:n,pool:r,accountAddr:o});case 17:return g=t.sent,(x=g.excessLiquidityTokens-c.excessLiquidityTokens)<0n&&(x=0n),t.abrupt("return",{round:f,fees:A,liquidityID:r.liquidityTokenID,liquidityOut:u+x,excessAmount:{excessAmountForAddingLiquidity:x,totalExcessAmount:g.excessLiquidityTokens},txnID:I,groupID:m});case 23:throw t.prev=23,t.t0=t.catch(1),"SlippageTolerance"===(T=new k(t.t0,"We encountered something unexpected while adding liquidity. Try again later.")).type&&T.setMessage("Adding liquidity failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),T;case 28:case"end":return t.stop()}}),t,null,[[1,23]])})))).apply(this,arguments)}var we=Object.freeze({__proto__:null,getQuote:function(t){var e=t.pool,n=t.reserves,r=t.asset1In,s=t.asset2In;if(0n===n.issuedLiquidity){var a=BigInt(Math.floor(Math.sqrt(Number(r)*Number(s))));if(a<=BigInt(1e3))throw new Error("Initial liquidity amount is too small. The amount must be greater than ".concat(1e3,", this quote is for ").concat(a,"."));return{round:n.round,asset1ID:e.asset1ID,asset1In:BigInt(r),asset2ID:e.asset2ID,asset2In:BigInt(s),liquidityID:e.liquidityTokenID,liquidityOut:a-BigInt(1e3),share:1}}var o=BigInt(r)*n.issuedLiquidity/n.asset1,i=BigInt(s)*n.issuedLiquidity/n.asset2,u=o<i?o:i;return{round:n.round,asset1ID:e.asset1ID,asset1In:BigInt(r),asset2ID:e.asset2ID,asset2In:BigInt(s),liquidityID:e.liquidityTokenID,liquidityOut:u,share:Gt.getPoolShare(n.issuedLiquidity+u,u)}},generateTxns:function(t){return ve.apply(this,arguments)},signTxns:function(t){return _e.apply(this,arguments)},execute:function(t){return Ne.apply(this,arguments)}});function Se(t){var e=t.assetIn,n=t.assetOut;return q(n.decimals,Number(n.amount))/q(e.decimals,Number(e.amount))}function be(t){var e=t.inputSupply,n=t.outputSupply,r=t.assetIn,s=t.assetOut,a=Se({assetIn:r,assetOut:s}),o=q(s.decimals,Number(n))/q(r.decimals,Number(e));return J({decimalPlaces:5},Math.abs(a/o-1))}function Pe(t,e,n,r,s){var a,o,i,u,c=t.asset1*t.asset2,p=t.asset1+BigInt(n),l=t.asset2+BigInt(r),d=p*l,f=BigInt(parseInt(String(Math.sqrt(Number(d*t.issuedLiquidity*t.issuedLiquidity/c))))),I=f-t.issuedLiquidity,A=I*p/f,m=I*l/f,g=BigInt(n)-A,x=BigInt(r)-m;if(g>x){var T=g;i=BigInt(Math.abs(Math.min(Number(x),0))),a=!0,o=T+(u=ke(T,e)),I-=u*f/(p*BigInt(2))}else{var h=x;i=BigInt(Math.abs(Math.min(Number(g),0))),a=!1,o=h+(u=ke(h,e)),I-=u*f/(l*BigInt(2))}return{poolTokenAssetAmount:I,swapFromAsset1ToAsset2:a,swapInAmount:o,swapOutAmount:i,swapTotalFeeAmount:u,swapPriceImpact:be({inputSupply:a?t.asset1:t.asset2,outputSupply:a?t.asset2:t.asset1,assetIn:{amount:o,decimals:s.asset1},assetOut:{amount:i,decimals:s.asset2}})}}function ke(t,e){return t*BigInt(e)/(BigInt(1e4)-BigInt(e))}function Re(t){var e=t.txGroup;return(0,t.initiatorSigner)([e])}function Oe(t){return Be.apply(this,arguments)}function Be(){return(Be=c(i().mark((function e(n){var r,s,a,o,u,c,p,l,d,f,I,A,m,g,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.client,s=n.pool,a=n.txGroup,o=n.signedTxns,e.prev=1,e.next=4,Y(r,[o]);case 4:return u=e.sent,c=E(u,1),p=c[0],l=p.confirmedRound,d=p.txnID,f=a[a.length-1].txn.txID(),e.next=12,t.waitForConfirmation(r,f,1e3);case 12:return I=e.sent,A=I["inner-txns"].find((function(t){return"axfer"===t.txn.txn.type})).txn.txn,m=W(a),g=Z(a),e.abrupt("return",{round:l,assetOut:{amount:A.aamt,assetID:A.xaid},fees:m,liquidityID:s.liquidityTokenID,txnID:d,groupID:g});case 19:throw e.prev=19,e.t0=e.catch(1),"SlippageTolerance"===(x=new k(e.t0,"We encountered something unexpected while adding liquidity. Try again later.")).type&&x.setMessage("Adding liquidity failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),x;case 24:case"end":return e.stop()}}),e,null,[[1,19]])})))).apply(this,arguments)}function Me(){return(Me=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,I,A,m,g,x,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.network,o=n.poolAddress,u=n.asset_1,c=n.pool,p=n.asset_2,l=n.liquidityToken,d=n.initiatorAddr,f=n.minPoolTokenAssetAmount,e.next=3,s.getTransactionParams().do();case 3:return I=e.sent,A=st(p.id),m=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:o,assetIndex:c.asset1ID,amount:u.amount,suggestedParams:I}),g=A?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:o,amount:p.amount,suggestedParams:I}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:o,assetIndex:c.asset2ID,amount:p.amount,suggestedParams:I}),(x=r.default.makeApplicationNoOpTxnFromObject({from:d,appIndex:pt(a,ot.V2),appArgs:[].concat(D(De.v2.FLEXIBLE_MODE),[t.encodeUint64(f)]),accounts:[o],foreignAssets:[l.id],suggestedParams:I})).fee=(ye+1)*t.ALGORAND_MIN_TX_FEE,T=r.default.assignGroupID([m,g,x]),e.abrupt("return",[{txn:T[0],signers:[d]},{txn:T[1],signers:[d]},{txn:T[2],signers:[d]}]);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qe=Object.freeze({__proto__:null,getQuote:function(t){var e=t.pool,n=t.slippage,r=void 0===n?.05:n,s=t.asset1,a=t.asset2;if(0n===e.issuedPoolTokens)throw new Error("Pool has no liquidity at the moment. To be able to do Flexible Swap, you should first add initial liquidity.");if(e.status!==exports.PoolStatus.READY)throw new Error("Pool is not ready");var o=Pe({asset1:e.asset1Reserves||0n,asset2:e.asset2Reserves||0n,issuedLiquidity:e.issuedPoolTokens||0n},e.totalFeeShare,s.amount,a.amount,{asset1:s.decimals,asset2:a.decimals}),i=o.poolTokenAssetAmount,u=o.swapInAmount,c=o.swapOutAmount,p=o.swapPriceImpact,l={amountIn:u,amountOut:c,swapFees:o.swapTotalFeeAmount,priceImpact:p},d=i-BigInt(Math.ceil(Number(i)*r));return{asset1ID:e.asset1ID,asset2ID:e.asset2ID,asset1In:BigInt(s.amount),asset2In:BigInt(a.amount),liquidityOut:i,liquidityID:e.liquidityTokenID,share:Gt.getPoolShare(e.issuedPoolTokens||0n+c,c),slippage:r,swapQuote:l,minPoolTokenAssetAmountWithSlippage:d}},generateTxns:function(t){return Me.apply(this,arguments)},signTxns:Re,execute:Oe});function Le(){return(Le=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,I,A,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.network,o=n.poolAddress,u=n.assetIn,c=n.liquidityToken,p=n.initiatorAddr,l=n.minPoolTokenAssetAmount,e.next=3,s.getTransactionParams().do();case 3:return d=e.sent,f=st(u.id),I=f?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:p,to:o,amount:u.amount,suggestedParams:d}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:p,to:o,assetIndex:u.id,amount:u.amount,suggestedParams:d}),(A=r.default.makeApplicationNoOpTxnFromObject({from:p,appIndex:pt(a,ot.V2),appArgs:[].concat(D(De.v2.SINGLE_ASSET_MODE),[t.encodeUint64(l)]),accounts:[o],foreignAssets:[c.id],suggestedParams:d})).fee=(he+1)*t.ALGORAND_MIN_TX_FEE,m=r.default.assignGroupID([I,A]),e.abrupt("return",[{txn:m[0],signers:[p]},{txn:m[1],signers:[p]}]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fe=Object.freeze({__proto__:null,getQuote:function(t){var e=t.pool,n=t.assetIn,r=t.slippage,s=void 0===r?.05:r,a=t.decimals;if(0n===e.issuedPoolTokens)throw new Error("Pool has no liquidity");if(e.status!==exports.PoolStatus.READY)throw new Error("Pool is not ready");var o=n.id===e.asset1ID,i={asset1:e.asset1Reserves||0n,asset2:e.asset2Reserves||0n,issuedLiquidity:e.issuedPoolTokens||0n},u=Pe(i,e.totalFeeShare,o?n.amount:0,o?0:n.amount,a),c=u.poolTokenAssetAmount,p=u.swapInAmount,l=u.swapOutAmount,d=u.swapPriceImpact,f={amountIn:p,amountOut:l,swapFees:u.swapTotalFeeAmount,priceImpact:d},I=c-BigInt(Math.ceil(Number(c)*s));return{asset1ID:e.asset1ID,asset2ID:e.asset2ID,assetIn:BigInt(n.amount),liquidityOut:c,liquidityID:e.liquidityTokenID,share:Gt.getPoolShare(i.issuedLiquidity+l,l),slippage:s,swapQuote:f,minPoolTokenAssetAmountWithSlippage:I}},generateTxns:function(t){return Le.apply(this,arguments)},signTxns:Re,execute:Oe});function Ce(){return(Ce=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,I,A,m,g,x,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.pool,o=n.network,u=n.poolAddress,c=n.asset_1,p=n.asset_2,l=n.liquidityToken,d=n.initiatorAddr,f=st(a.asset2ID),e.next=4,s.getTransactionParams().do();case 4:return I=e.sent,A=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:u,assetIndex:a.asset1ID,amount:c.amount,suggestedParams:I}),m=f?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:u,amount:p.amount,suggestedParams:I}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:u,assetIndex:a.asset2ID,amount:p.amount,suggestedParams:I}),g=r.default.makeApplicationNoOpTxnFromObject({from:d,appIndex:pt(o,ot.V2),appArgs:De.v2.INITIAL_LIQUIDITY,accounts:[u],foreignAssets:[l.id],suggestedParams:I}),x=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:d,assetIndex:l.id,amount:0,suggestedParams:I}),g.fee=(Te+1)*t.ALGORAND_MIN_TX_FEE,(T=r.default.assignGroupID([x,A,m,g])).forEach((function(t){console.log(t instanceof r.default.Transaction)})),e.abrupt("return",[{txn:T[0],signers:[d]},{txn:T[1],signers:[d]},{txn:T[2],signers:[d]},{txn:T[3],signers:[d]}]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue,je,Ve=Object.freeze({__proto__:null,getQuote:function(t){var e=t.pool,n=t.asset1,r=t.asset2,s=t.slippage,a=void 0===s?.05:s;if(0n!==e.issuedPoolTokens)throw new Error("Pool already has liquidity");var o=BigInt(Math.floor(Math.sqrt(Number(n.amount)*Number(r.amount))));if(o<=BigInt(1e3))throw new Error("Initial liquidity mint too small. Liquidity minting amount must be greater than ".concat(1e3,", this quote is for ").concat(o,"."));var i=function(t,e){if(!t.amount||!e.amount)throw new Error("Both assets are required for the initial add liquidity");return BigInt(Math.abs(Math.floor(Math.sqrt(G(t.decimals,Math.floor(Number(t.amount)))*G(e.decimals,Math.floor(Number(e.amount))))-1e3)))}(n,r);return{asset1ID:e.asset1ID,asset2ID:e.asset2ID,asset1In:BigInt(n.amount),asset2In:BigInt(r.amount),poolTokenAssetAmount:i,slippage:a}},generateTxns:function(t){return Ce.apply(this,arguments)},signTxns:Re,execute:Oe}),Xe=Object.freeze({__proto__:null,flexible:Qe,withSingleAsset:Fe,initial:Ve}),qe=(f(Ue={},ot.V1_1,we),f(Ue,ot.V2,Xe),Ue);!function(t){t[t.FEE_TXN=0]="FEE_TXN",t[t.VALIDATOR_APP_CALL_TXN=1]="VALIDATOR_APP_CALL_TXN",t[t.ASSET1_OUT_TXN=2]="ASSET1_OUT_TXN",t[t.ASSET2_OUT_TXN=3]="ASSET2_OUT_TXN",t[t.LIQUDITY_IN_TXN=4]="LIQUDITY_IN_TXN"}(je||(je={}));var Ge,Je=Object.values(je).length,Ye=K("remove_liquidity");function ze(){return(ze=c(i().mark((function t(e){var n,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,E,D,v;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,a=e.pool,o=e.liquidityIn,u=e.asset1Out,c=e.asset2Out,p=e.slippage,l=e.initiatorAddr,t.next=3,n.getTransactionParams().do();case 3:return d=t.sent,f=a.account.address(),I=st(a.asset2ID),A=r.default.makeApplicationNoOpTxnFromObject({from:f,appIndex:a.validatorAppID,appArgs:[K("burn")],accounts:[l],foreignAssets:I?[a.asset1ID,a.liquidityTokenID]:[a.asset1ID,a.asset2ID,a.liquidityTokenID],suggestedParams:d}),m=X("negative",p,u),g=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:l,assetIndex:a.asset1ID,amount:m,suggestedParams:d}),x=X("negative",p,c),T=I?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:f,to:l,amount:x,suggestedParams:d}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:l,assetIndex:a.asset2ID,amount:x,suggestedParams:d}),h=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:l,to:f,assetIndex:a.liquidityTokenID,amount:o,suggestedParams:d}),y=A.fee+g.fee+T.fee,E=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:f,amount:y,note:s,suggestedParams:d}),(D=[])[je.FEE_TXN]=E,D[je.VALIDATOR_APP_CALL_TXN]=A,D[je.ASSET1_OUT_TXN]=g,D[je.ASSET2_OUT_TXN]=T,D[je.LIQUDITY_IN_TXN]=h,v=r.default.assignGroupID(D),t.abrupt("return",[{txn:v[je.FEE_TXN],signers:[l]},{txn:v[je.VALIDATOR_APP_CALL_TXN],signers:[f]},{txn:v[je.ASSET1_OUT_TXN],signers:[f]},{txn:v[je.ASSET2_OUT_TXN],signers:[f]},{txn:v[je.LIQUDITY_IN_TXN],signers:[l]}]);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function We(){return(We=c(i().mark((function t(e){var n,s,a,o,u,c,p,l,d;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.pool,s=e.txGroup,a=e.initiatorSigner,t.next=3,a([s]);case 3:return o=t.sent,u=E(o,2),c=u[0],p=u[1],l=n.account,d=s.map((function(t,e){return e===je.FEE_TXN?c:e===je.LIQUDITY_IN_TXN?p:r.default.signLogicSigTransactionObject(t.txn,l).blob})),t.abrupt("return",d);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ze(){return(Ze=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.pool,s=e.txGroup,a=e.signedTxns,o=e.initiatorAddr,t.prev=1,u=s[je.ASSET1_OUT_TXN].txn.amount,c=s[je.ASSET2_OUT_TXN].txn.amount,p=s[je.LIQUDITY_IN_TXN].txn.amount,t.next=7,_t({client:n,pool:r,accountAddr:o});case 7:return l=t.sent,t.next=10,Y(n,[a]);case 10:return d=t.sent,f=E(d,1),I=f[0],A=I.confirmedRound,m=I.txnID,t.next=17,_t({client:n,pool:r,accountAddr:o});case 17:return g=t.sent,(x=g.excessAsset1-l.excessAsset1)<0n&&(x=0n),(T=g.excessAsset2-l.excessAsset2)<0n&&(T=0n),t.abrupt("return",{round:A,fees:W(s),asset1ID:r.asset1ID,asset1Out:BigInt(u)+x,asset2ID:r.asset2ID,asset2Out:BigInt(c)+T,liquidityID:r.liquidityTokenID,liquidityIn:BigInt(p),excessAmounts:[{assetID:r.asset1ID,excessAmountForBurning:x,totalExcessAmount:g.excessAsset1},{assetID:r.asset2ID,excessAmountForBurning:T,totalExcessAmount:g.excessAsset2}],txnID:m,groupID:Z(s)});case 25:throw t.prev=25,t.t0=t.catch(1),"SlippageTolerance"===(h=new k(t.t0,"We encountered something unexpected while burning liquidity. Try again later.")).type&&h.setMessage("The burn failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),h;case 30:case"end":return t.stop()}}),t,null,[[1,25]])})))).apply(this,arguments)}!function(t){t[t.ASSET_TRANSFER_TXN=0]="ASSET_TRANSFER_TXN",t[t.APP_CALL_TXN=1]="APP_CALL_TXN"}(Ge||(Ge={}));var He,Ke,$e,tn,en={generateTxns:function(t){return ze.apply(this,arguments)},getQuote:function(t){var e=t.pool,n=t.reserves,r=t.liquidityIn,s=BigInt(r),a=n.issuedLiquidity&&s*n.asset1/n.issuedLiquidity,o=n.issuedLiquidity&&s*n.asset2/n.issuedLiquidity;return{round:n.round,liquidityID:e.liquidityTokenID,liquidityIn:s,asset1ID:e.asset1ID,asset1Out:a,asset2ID:e.asset2ID,asset2Out:o}},signTxns:function(t){return We.apply(this,arguments)},execute:function(t){return Ze.apply(this,arguments)}};exports.SwapType=void 0,(He=exports.SwapType||(exports.SwapType={})).FixedInput="fixed-input",He.FixedOutput="fixed-output",function(t){t[t.INPUT_TXN=0]="INPUT_TXN",t[t.APP_CALL_TXN=1]="APP_CALL_TXN"}(tn||(tn={}));var nn=(f(Ke={},exports.SwapType.FixedInput,1),f(Ke,exports.SwapType.FixedOutput,2),Ke),rn=K("swap"),sn=(f($e={},exports.SwapType.FixedInput,K("fixed-input")),f($e,exports.SwapType.FixedOutput,K("fixed-output")),$e);function an(){return(an=c(i().mark((function t(e){var n,s,a,o,u,c,p,l,d,f,I,A,m,g,x,T;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,s=e.pool,a=e.swapType,o=e.assetIn,u=e.assetOut,c=e.initiatorAddr,p=e.slippage,t.next=3,n.getTransactionParams().do();case 3:return l=t.sent,d=s.account.address(),f=st(o.assetID),I=a===exports.SwapType.FixedInput?o.amount:X("positive",p,o.amount),A=a===exports.SwapType.FixedOutput?u.amount:X("negative",p,u.amount),m=f?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:c,to:d,amount:I,suggestedParams:l}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:c,to:d,amount:I,assetIndex:o.assetID,suggestedParams:l}),(g=r.default.makeApplicationNoOpTxnFromObject({from:c,appIndex:s.validatorAppID,appArgs:[rn,sn[a],r.default.encodeUint64(A)],accounts:[d],foreignAssets:[s.asset1ID,s.asset2ID],suggestedParams:l})).fee=on(a),(x=[])[tn.INPUT_TXN]=m,x[tn.APP_CALL_TXN]=g,T=r.default.assignGroupID(x),t.abrupt("return",[{txn:T[tn.INPUT_TXN],signers:[c]},{txn:T[tn.APP_CALL_TXN],signers:[c]}]);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function on(e){return(nn[e]+1)*t.ALGORAND_MIN_TX_FEE}function un(){return(un=c(i().mark((function e(n){var r,s,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,D;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.client,o=n.pool,u=n.txGroup,c=n.signedTxns,p=n.network,l=n.assetIn,e.next=3,Y(a,[c]);case 3:return d=e.sent,f=E(d,1),I=f[0],A=I.confirmedRound,m=I.txnID,g=u[tn.APP_CALL_TXN].txn.txID(),e.next=11,t.waitForConfirmation(a,g,1e3);case 11:if(x=e.sent,T=x["inner-txns"],h=[o.asset1ID,o.asset2ID].filter((function(t){return t!==l.assetID}))[0],y=null===(r=T.find((function(t){return t.txn.txn.xaid===l.assetID})))||void 0===r?void 0:r.txn.txn,D=null===(s=T.find((function(t){return t.txn.txn.xaid===h})))||void 0===s?void 0:s.txn.txn){e.next=19;break}throw console.log({confirmedRound:A,txnID:m}),new Error("Txn was successful, but asset out inner txn not found.");case 19:return e.t0=A,e.t1={amount:BigInt(l.amount)-BigInt((null==y?void 0:y.aamt)||0),assetID:l.assetID},e.t2={amount:null==D?void 0:D.aamt,assetID:h},e.next=24,Gt.v2.getPoolInfo({client:a,network:p,asset1ID:o.asset1ID,asset2ID:o.asset2ID});case 24:return e.t3=e.sent,e.t4=x,e.t5=m,e.abrupt("return",{round:e.t0,assetIn:e.t1,assetOut:e.t2,pool:e.t3,appCallTxnResponse:e.t4,txnID:e.t5});case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cn(t){var e=t.pool,n=t.assetIn,r=t.decimals;if(e.status!==exports.PoolStatus.READY)throw new k({pool:e,assetIn:n},"Trying to swap on a non-existent pool");var s,a,o,i=BigInt(n.amount),u=e.totalFeeShare;n.assetID===e.asset1ID?(s=e.asset2ID,a=e.asset1Reserves,o=e.asset2Reserves):(s=e.asset1ID,a=e.asset2Reserves,o=e.asset1Reserves);var c=ln({inputSupply:a,outputSupply:o,swapInputAmount:i,totalFeeShare:u,decimals:r}),p=c.swapOutputAmount,l=c.totalFeeAmount,d=c.priceImpact;return{assetInID:n.assetID,assetInAmount:i,assetOutID:s,assetOutAmount:p,swapFee:Number(l),rate:q(r.assetOut,Number(p))/q(r.assetIn,Number(i)),priceImpact:d}}function pn(t){var e,n,r,s=t.pool,a=t.assetOut,o=t.decimals,i=BigInt(a.amount),u=s.totalFeeShare;a.assetID===s.asset1ID?(e=s.asset2ID,n=s.asset2Reserves,r=s.asset1Reserves):(e=s.asset1ID,n=s.asset1Reserves,r=s.asset2Reserves);var c=function(t){var e=t.inputSupply,n=t.outputSupply,r=t.swapOutputAmount,s=t.totalFeeShare,a=t.decimals,o=function(t){var e=t.inputSupply,n=t.outputSupply,r=t.outputAmount,s=BigInt(e*n/(n-r))-e;return s+=BigInt(1)}({inputSupply:e,outputSupply:n,outputAmount:r}),i=function(t){var e=t.swapAmount,n=t.totalFeeShare,r=Math.floor(Number(e*BigInt(1e4)/(BigInt(1e4)-BigInt(n))));return BigInt(r)-e}({swapAmount:o,totalFeeShare:s}),u=o+i,c=be({inputSupply:e,outputSupply:n,assetIn:{amount:u,decimals:a.assetIn},assetOut:{amount:r,decimals:a.assetOut}});return{swapInputAmount:u,totalFeeAmount:i,priceImpact:c}}({inputSupply:n,outputSupply:r,swapOutputAmount:i,totalFeeShare:u,decimals:o}),p=c.swapInputAmount,l=c.totalFeeAmount,d=c.priceImpact;return{assetInID:e,assetInAmount:p,assetOutID:a.assetID,assetOutAmount:i,swapFee:Number(l),rate:q(o.assetOut,Number(i))/q(o.assetIn,Number(p)),priceImpact:d}}function ln(t){var e=t.inputSupply,n=t.outputSupply,r=t.swapInputAmount,s=t.totalFeeShare,a=t.decimals,o=BigInt(function(t){var e=t.inputAmount,n=t.totalFeeShare;return Math.floor(Number(e*BigInt(n))/1e4)}({inputAmount:r,totalFeeShare:s})),i=function(t){var e=t.inputSupply,n=t.outputSupply,r=t.swapAmount,s=n-BigInt(e*n/(e+BigInt(r)));return s-=BigInt(1)}({inputSupply:e,outputSupply:n,swapAmount:r-o});return{swapOutputAmount:i,totalFeeAmount:o,priceImpact:be({inputSupply:e,outputSupply:n,assetIn:{amount:r,decimals:a.assetIn},assetOut:{amount:i,decimals:a.assetOut}})}}var dn={getQuote:function(t,e,n,r){if(e.status!==exports.PoolStatus.READY)throw new k({pool:e,asset:n},"Trying to swap on a non-existent pool");return t===exports.SwapType.FixedInput?cn({pool:e,assetIn:n,decimals:r}):pn({pool:e,assetOut:n,decimals:r})},getFixedInputSwapQuote:cn,getFixedOutputSwapQuote:pn,generateTxns:function(t){return an.apply(this,arguments)},signTxns:function(t){var e=t.txGroup;return(0,t.initiatorSigner)([e])},execute:function(t){return un.apply(this,arguments)},calculateFixedInputSwap:ln};function fn(t,e){var n,r,s=BigInt(t),a=e.issuedLiquidity;return a>s+BigInt(1e3)?(n=s*e.asset1/a,r=s*e.asset2/a):(n=e.asset1,r=e.asset2),{asset1OutputAmount:n,asset2OutputAmount:r}}function In(){return(In=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,I,A,m,g,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.pool,o=n.poolTokenIn,u=n.initiatorAddr,c=n.minAsset1Amount,p=n.minAsset2Amount,l=n.slippage,e.next=3,s.getTransactionParams().do();case 3:if(d=e.sent,f=a.account.address(),I=a.liquidityTokenID){e.next=8;break}throw new Error("Pool token asset ID is missing");case 8:return A=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:u,to:f,assetIndex:I,amount:o,suggestedParams:d}),(m=r.default.makeApplicationNoOpTxnFromObject({from:u,appIndex:a.validatorAppID,appArgs:[Ye,r.default.encodeUint64(gn(BigInt(c),l)),r.default.encodeUint64(gn(BigInt(p),l))],accounts:[f],foreignAssets:[a.asset1ID,a.asset2ID],suggestedParams:d})).fee=3*t.ALGORAND_MIN_TX_FEE,(g=[])[Ge.ASSET_TRANSFER_TXN]=A,g[Ge.APP_CALL_TXN]=m,x=r.default.assignGroupID(g),e.abrupt("return",[{txn:x[Ge.ASSET_TRANSFER_TXN],signers:[u]},{txn:x[Ge.APP_CALL_TXN],signers:[u]}]);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function An(){return(An=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y,E,D;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.pool,o=n.initiatorAddr,u=n.poolTokenIn,c=n.outputAssetId,p=n.minOutputAssetAmount,l=n.slippage,e.next=3,s.getTransactionParams().do();case 3:if(d=e.sent,f=a.asset1ID,I=a.asset2ID,A=a.account.address(),m=a.liquidityTokenID){e.next=9;break}throw new Error("Pool token asset ID is missing");case 9:if(g=0,x=0,T=gn(BigInt(p),l),c!==f){e.next=17;break}g=T,x=0,e.next=23;break;case 17:if(c!==I){e.next=22;break}g=0,x=T,e.next=23;break;case 22:throw new Error("Invalid output asset id. It doesn't match with pool assets");case 23:return h=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:o,to:A,assetIndex:m,amount:u,suggestedParams:d}),(y=r.default.makeApplicationNoOpTxnFromObject({from:o,appIndex:a.validatorAppID,appArgs:[Ye,r.default.encodeUint64(g),r.default.encodeUint64(x)],accounts:[A],foreignAssets:[c],suggestedParams:d})).fee=3*t.ALGORAND_MIN_TX_FEE,(E=[])[Ge.ASSET_TRANSFER_TXN]=h,E[Ge.APP_CALL_TXN]=y,D=r.default.assignGroupID(E),e.abrupt("return",[{txn:D[Ge.ASSET_TRANSFER_TXN],signers:[o]},{txn:D[Ge.APP_CALL_TXN],signers:[o]}]);case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mn(){return(mn=c(i().mark((function e(n){var r,s,a,o,u,c,p,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.client,s=n.txGroup,a=n.signedTxns,e.next=3,Y(r,[a]);case 3:return o=e.sent,u=E(o,1),c=u[0].txnID,p=s[Ge.APP_CALL_TXN].txn.txID(),e.next=9,t.waitForConfirmation(r,p,1e3);case 9:return l=e.sent,d=l["inner-txns"].map((function(t){return{assetId:t.txn.txn.xaid,amount:t.txn.txn.aamt}})),e.abrupt("return",{appCallTxnResult:l,outputAssets:d,txnID:c,appCallTxnId:p});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gn(t,e){return t-(n=1e15,t*BigInt(n*e)/BigInt(n));var n}var xn,Tn,hn={getQuote:function(t){var e=t.pool,n=t.reserves,r=t.poolTokenIn,s=BigInt(r),a=fn(s,n),o=a.asset1OutputAmount,i=a.asset2OutputAmount;return{round:n.round,asset1Out:{assetId:e.asset1ID,amount:o},asset2Out:{assetId:e.asset2ID,amount:i},poolTokenIn:{assetId:e.liquidityTokenID,amount:s}}},getSingleAssetRemoveLiquidityQuote:function(t){var e,n=t.pool,r=t.reserves,s=t.poolTokenIn,a=t.assetOutID,o=t.decimals,i=BigInt(s),u=fn(i,r),c=u.asset1OutputAmount,p=u.asset2OutputAmount,l=n.totalFeeShare;if(a===n.asset1ID){var d=dn.calculateFixedInputSwap({inputSupply:r.asset2-p,outputSupply:r.asset1-c,swapInputAmount:p,totalFeeShare:l,decimals:o}),f=d.swapOutputAmount,I=d.totalFeeAmount,A=d.priceImpact;e={round:r.round,assetOut:{assetId:a,amount:c+f},poolTokenIn:{assetId:n.liquidityTokenID,amount:i},internalSwapQuote:{amountIn:{assetId:n.asset2ID,amount:p},amountOut:{assetId:n.asset1ID,amount:f},swapFees:{assetId:n.asset2ID,amount:I},priceImpact:A}}}else{if(a!==n.asset2ID)throw new Error("assetOutID must be one of the pool assets");var m=dn.calculateFixedInputSwap({inputSupply:r.asset1-c,outputSupply:r.asset2-p,swapInputAmount:c,totalFeeShare:l,decimals:o}),g=m.swapOutputAmount,x=m.totalFeeAmount,T=m.priceImpact;e={round:r.round,assetOut:{assetId:a,amount:p+g},poolTokenIn:{assetId:n.liquidityTokenID,amount:i},internalSwapQuote:{amountIn:{assetId:n.asset2ID,amount:p},amountOut:{assetId:n.asset1ID,amount:g},swapFees:{assetId:n.asset2ID,amount:x},priceImpact:T}}}return e},getAmountWithSlippage:gn,generateTxns:function(t){return In.apply(this,arguments)},generateSingleAssetOutTxns:function(t){return An.apply(this,arguments)},signTxns:function(t){var e=t.txGroup;return(0,t.initiatorSigner)([e])},execute:function(t){return mn.apply(this,arguments)}},yn=(f(xn={},ot.V1_1,en),f(xn,ot.V2,hn),xn),En=3n,Dn=1000n;function vn(){return(vn=c(i().mark((function t(e){var n,s,a,o,u,c,p,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.pool,s=e.txGroup,a=e.initiatorSigner,t.next=3,a([s]);case 3:return o=t.sent,u=E(o,2),c=u[0],p=u[1],l=s.map((function(t,e){return e===Tn.FEE_TXN_INDEX?c:e===Tn.ASSET_IN_TXN_INDEX?p:r.default.signLogicSigTransactionObject(t.txn,n.account.lsig).blob})),t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _n(){return(_n=c(i().mark((function t(e){var n,a,o,u,c,p,l,d,f,I,A,m,g,x,T,h,y;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,a=e.pool,o=e.swapType,u=e.assetIn,c=e.assetOut,p=e.slippage,l=e.initiatorAddr,t.next=3,n.getTransactionParams().do();case 3:return d=t.sent,f=a.account.address(),I=[K("swap"),o===exports.SwapType.FixedInput?K("fi"):K("fo")],A=r.default.makeApplicationNoOpTxnFromObject({from:f,appIndex:a.validatorAppID,appArgs:I,accounts:[l],foreignAssets:0==a.asset2ID?[a.asset1ID,a.liquidityTokenID]:[a.asset1ID,a.asset2ID,a.liquidityTokenID],suggestedParams:d}),m=o===exports.SwapType.FixedOutput?X("positive",p,u.amount):u.amount,g=0===u.assetID?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:f,amount:m,suggestedParams:d}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:l,to:f,assetIndex:u.assetID,amount:m,suggestedParams:d}),x=o===exports.SwapType.FixedInput?X("negative",p,c.amount):c.amount,T=0===c.assetID?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:f,to:l,amount:x,suggestedParams:d}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:l,assetIndex:c.assetID,amount:x,suggestedParams:d}),h=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:f,amount:A.fee+T.fee,note:s,suggestedParams:d}),y=r.default.assignGroupID([h,A,g,T]),t.abrupt("return",[{txn:y[0],signers:[l]},{txn:y[1],signers:[f]},{txn:y[2],signers:[l]},{txn:y[3],signers:[f]}]);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Nn(t){var e,n,r,s=t.pool,a=t.reserves,i=t.assetIn,u=t.decimals,c=BigInt(i.amount);i.assetID===s.asset1ID?(e=s.asset2ID,n=a.asset1,r=a.asset2):(e=s.asset1ID,n=a.asset2,r=a.asset1);var p=c*En/Dn,l=r-n*r/(n+(c-p));if(l>r)throw new Error("Output amount exceeds available liquidity.");var d={assetIn:{amount:c,decimals:u.assetIn},assetOut:{amount:l,decimals:u.assetOut}};return{round:a.round,assetInID:i.assetID,assetInAmount:c,assetOutID:e,assetOutAmount:l,swapFee:Number(p),rate:Se(d),priceImpact:be(o({inputSupply:n,outputSupply:r},d))}}function wn(t){return Sn.apply(this,arguments)}function Sn(){return(Sn=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d,f,I,A,m,g,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.pool,s=e.signedTxns,a=e.assetIn,o=e.assetOut,u=e.initiatorAddr,t.next=3,_t({client:n,pool:r,accountAddr:u});case 3:return c=t.sent,t.next=6,Y(n,[s]);case 6:return p=t.sent,l=E(p,1),d=l[0],f=d.confirmedRound,I=d.txnID,t.next=13,_t({client:n,pool:r,accountAddr:u});case 13:return A=t.sent,o.assetID===r.asset1ID?(m=c.excessAsset1,g=A.excessAsset1):(m=c.excessAsset2,g=A.excessAsset2),(x=g-m)<0n&&(x=0n),t.abrupt("return",{round:f,assetInID:a.assetID,assetInAmount:BigInt(a.amount),assetOutID:o.assetID,assetOutAmount:BigInt(o.amount)+x,excessAmount:{assetID:o.assetID,excessAmountForSwap:x,totalExcessAmount:g},txnID:I});case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function bn(t){var e,n,r,s=t.pool,a=t.reserves,o=t.assetOut,i=t.decimals,u=BigInt(o.amount);if(o.assetID===s.asset1ID?(e=s.asset2ID,n=a.asset2,r=a.asset1):(e=s.asset1ID,n=a.asset1,r=a.asset2),u>r)throw new Error("Output amount exceeds available liquidity.");var c=n*r/(r-u)-n,p=c*Dn/(Dn-En),l=p-c,d=q(i.assetOut,Number(u))/q(i.assetIn,Number(p)),f=q(i.assetOut,Number(r))/q(i.assetIn,Number(n)),I=J({decimalPlaces:5},Math.abs(d/f-1));return{round:a.round,assetInID:e,assetInAmount:p,assetOutID:o.assetID,assetOutAmount:u,swapFee:Number(l),rate:d,priceImpact:I}}function Pn(t){return kn.apply(this,arguments)}function kn(){return(kn=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d,f,I,A,m,g,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.pool,s=e.signedTxns,a=e.assetIn,o=e.assetOut,u=e.initiatorAddr,t.next=3,_t({client:n,pool:r,accountAddr:u});case 3:return c=t.sent,t.next=6,Y(n,[s]);case 6:return p=t.sent,l=E(p,1),d=l[0],f=d.confirmedRound,I=d.txnID,t.next=13,_t({client:n,pool:r,accountAddr:u});case 13:return A=t.sent,a.assetID===r.asset1ID?(m=c.excessAsset1,g=A.excessAsset1):(m=c.excessAsset2,g=A.excessAsset2),(x=g-m)<0n&&(x=0n),t.abrupt("return",{round:f,assetInID:a.assetID,assetInAmount:BigInt(a.amount)-x,assetOutID:o.assetID,assetOutAmount:BigInt(o.amount),excessAmount:{assetID:a.assetID,excessAmountForSwap:x,totalExcessAmount:g},txnID:I});case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rn(){return(Rn=c(i().mark((function t(e){var n,r,s,a,u,c,p,l,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.client,r=e.pool,s=e.swapType,a=e.txGroup,u=e.signedTxns,c=e.initiatorAddr,r.status===exports.PoolStatus.READY){t.next=3;break}throw new k({pool:r,swapType:s,txGroup:a},"Trying to swap on a non-existent pool");case 3:if(t.prev=3,p={assetID:a[Tn.ASSET_IN_TXN_INDEX].txn.assetIndex||0,amount:a[Tn.ASSET_IN_TXN_INDEX].txn.amount},l={assetID:a[Tn.ASSET_OUT_TXN_INDEX].txn.assetIndex||0,amount:a[Tn.ASSET_OUT_TXN_INDEX].txn.amount},s!==exports.SwapType.FixedInput){t.next=12;break}return t.next=9,wn({client:n,pool:r,signedTxns:u,assetIn:p,assetOut:l,initiatorAddr:c});case 9:d=t.sent,t.next=15;break;case 12:return t.next=14,Pn({client:n,pool:r,signedTxns:u,assetIn:p,assetOut:l,initiatorAddr:c});case 14:d=t.sent;case 15:return t.abrupt("return",o(o({},d),{},{groupID:Z(a),fees:W(a)}));case 18:throw t.prev=18,t.t0=t.catch(3),"SlippageTolerance"===(f=new k(t.t0,"We encountered something unexpected while swapping. Try again later.")).type&&f.setMessage("The swap failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),f;case 23:case"end":return t.stop()}}),t,null,[[3,18]])})))).apply(this,arguments)}!function(t){t[t.FEE_TXN_INDEX=0]="FEE_TXN_INDEX",t[t.VALIDATOR_APP_CALL_TXN_INDEX=1]="VALIDATOR_APP_CALL_TXN_INDEX",t[t.ASSET_IN_TXN_INDEX=2]="ASSET_IN_TXN_INDEX",t[t.ASSET_OUT_TXN_INDEX=3]="ASSET_OUT_TXN_INDEX"}(Tn||(Tn={}));var On,Bn={getQuote:function(t,e,n,r,s){if(e.status!==exports.PoolStatus.READY)throw new k({pool:e,asset:r},"Trying to swap on a non-existent pool");return t===exports.SwapType.FixedInput?Nn({pool:e,reserves:n,assetIn:r,decimals:s}):bn({pool:e,reserves:n,assetOut:r,decimals:s})},getFixedInputSwapQuote:Nn,getFixedOutputSwapQuote:bn,generateTxns:function(t){return _n.apply(this,arguments)},signTxns:function(t){return vn.apply(this,arguments)},execute:function(t){return Rn.apply(this,arguments)},executeFixedOutputSwap:Pn};function Mn(t){return D(t).sort((function(t,e){return e.quote.rate-t.quote.rate}))[0]}var Qn=(f(On={},ot.V1_1,Bn),f(On,ot.V2,dn),f(On,"getQuote",(function(t){return t.type===exports.SwapType.FixedInput?(n=(e=t).pools,r=e.assetIn,s=e.assetOut,a=e.amount,Mn(n.map((function(t){var e={pool:t.info,assetIn:{amount:a,assetID:Number(r.id)},decimals:{assetIn:r.decimals,assetOut:s.decimals},reserves:t.reserves};return{pool:t,quote:t.info.contractVersion===ot.V1_1?Bn.getFixedInputSwapQuote(e):dn.getFixedInputSwapQuote(e)}})))):function(t){var e=t.pools,n=t.assetIn,r=t.assetOut,s=t.amount;return Mn(e.map((function(t){var e={pool:t.info,assetOut:{amount:s,assetID:Number(r.id)},decimals:{assetIn:n.decimals,assetOut:r.decimals},reserves:t.reserves};return{pool:t,quote:t.info.contractVersion===ot.V1_1?Bn.getFixedOutputSwapQuote(e):dn.getFixedOutputSwapQuote(e)}})))}(t);var e,n,r,s,a})),f(On,"generateTxns",(function(t){return t.pool.contractVersion===ot.V1_1?Bn.generateTxns(t):dn.generateTxns(t)})),f(On,"signTxns",(function(t){return t.pool.contractVersion===ot.V1_1?Bn.signTxns(t):dn.signTxns(t)})),f(On,"execute",(function(t){return t.contractVersion===ot.V1_1?Bn.execute(t):dn.execute(t)})),On);function Ln(){return(Ln=c(i().mark((function t(e){var n,r,s,a,o,u,c,p,l,d;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.pool,s=e.txGroup,a=e.initiatorSigner,t.prev=1,t.next=4,Fn({txGroup:s,pool:r,initiatorSigner:a});case 4:return o=t.sent,t.next=7,Y(n,[o]);case 7:return u=t.sent,c=E(u,1),p=c[0],l=p.txnID,d=p.confirmedRound,t.abrupt("return",{fees:W(s),confirmedRound:d,txnID:l,groupID:Z(s)});case 15:throw t.prev=15,t.t0=t.catch(1),new k(t.t0,"We encountered something unexpected while redeeming. Try again later.");case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))).apply(this,arguments)}function Fn(t){return Cn.apply(this,arguments)}function Cn(){return(Cn=c(i().mark((function t(e){var n,s,a,o,u,c,p,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.txGroup,s=e.pool,a=e.initiatorSigner,t.next=3,a([n]);case 3:return o=t.sent,u=E(o,1),c=u[0],p=s.account.lsig,l=n.map((function(t,e){return 0===e?c:r.default.signLogicSigTransactionObject(t.txn,p).blob})),t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Un(){return Un=c(i().mark((function t(e){var n,s,a,o,u,p;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,s=e.data,a=e.initiatorSigner,t.prev=1,o=s.map((function(t){var e=t.txGroup,n=t.pool;return{txns:e,txnFees:W(e),groupID:Z(e),lsig:n.account.lsig}})),t.next=5,a(o.map((function(t){return t.txns})));case 5:return u=t.sent,p=Promise.all(o.map((function(t,e){return new Promise(function(){var s=c(i().mark((function s(a,o){var c,p,l,d,f,I;return i().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,c=t.txns.map((function(n,s){return 0===s?u[e]:r.default.signLogicSigTransactionObject(n.txn,t.lsig).blob})),s.next=4,Y(n,[c]);case 4:p=s.sent,l=E(p,1),d=l[0],f=d.txnID,I=d.confirmedRound,a({fees:t.txnFees,groupID:t.groupID,txnID:f,confirmedRound:I}),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(0),o(s.t0);case 15:case"end":return s.stop()}}),s,null,[[0,12]])})));return function(t,e){return s.apply(this,arguments)}}())}))),t.abrupt("return",p);case 10:throw t.prev=10,t.t0=t.catch(1),new k(t.t0,"We encountered something unexpected while redeeming. Try again later.");case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),Un.apply(this,arguments)}function jn(){return(jn=c(i().mark((function t(e){var n,a,o,u,c,p,l,d,f,I,A;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,a=e.pool,o=e.assetID,u=e.assetOut,c=e.initiatorAddr,t.next=3,n.getTransactionParams().do();case 3:return p=t.sent,l=a.account.address(),d=r.default.makeApplicationNoOpTxnFromObject({from:l,appIndex:a.validatorAppID,appArgs:[K("redeem")],accounts:[c],foreignAssets:0==a.asset2ID?[a.asset1ID,a.liquidityTokenID]:[a.asset1ID,a.asset2ID,a.liquidityTokenID],suggestedParams:p}),f=0===o?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:c,amount:BigInt(u),suggestedParams:p}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:l,to:c,assetIndex:o,amount:BigInt(u),suggestedParams:p}),I=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:c,to:l,amount:d.fee+f.fee,note:s,suggestedParams:p}),A=r.default.assignGroupID([I,d,f]),t.abrupt("return",[{txn:A[0],signers:[c]},{txn:A[1],signers:[l]},{txn:A[2],signers:[l]}]);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Vn(e){var n=e.suggestedParams,r=e.stakingAppID,s=e.initiatorAddr,a=e.liquidityAssetID,o=e.program,i=e.amount,u=t.encodeUint64(i),c=t.encodeUint64(o.id);return t.makeApplicationNoOpTxnFromObject({appIndex:r,from:s,suggestedParams:n,foreignAssets:[a],accounts:[o.accountAddress],appArgs:[K("commit"),u],note:O([K("tinymanStaking/v1:b"),c,t.encodeUint64(a),u])})}function Xn(){return(Xn=c(i().mark((function e(n){var r,s,a,o,u,c,p,l,d,f,I;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.client,s=n.stakingAppID,a=n.program,o=n.requiredAssetID,u=n.liquidityAssetID,c=n.amount,p=n.initiatorAddr,e.next=3,r.getTransactionParams().do();case 3:if(l=e.sent,d=Vn({suggestedParams:l,stakingAppID:s,program:a,liquidityAssetID:u,initiatorAddr:p,amount:c}),f=[d],"number"!=typeof o){e.next=10;break}return I=t.makeApplicationNoOpTxnFromObject({appIndex:s,from:p,suggestedParams:l,foreignAssets:[o],accounts:[a.accountAddress],appArgs:[K("log_balance")]}),f=t.assignGroupID([d,I]),e.abrupt("return",[{txn:f[0],signers:[p]},{txn:f[1],signers:[p]}]);case 10:return e.abrupt("return",[{txn:f[0],signers:[p]}]);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}exports.ALGO_ASSET=$,exports.ALGO_ASSET_ID=0,exports.ASSET_OPT_IN_PROCESS_TXN_COUNT=1,exports.AddLiquidity=qe,exports.BASE_MINIMUM_BALANCE=1e5,exports.Bootstrap=Ie,exports.CONTRACT_VERSION=ot,exports.MINIMUM_ADD_LIQUIDITY_AMOUNT=1e3,exports.MINIMUM_BALANCE_REQUIRED_PER_APP=1e5,exports.MINIMUM_BALANCE_REQUIRED_PER_ASSET=1e5,exports.MINIMUM_BALANCE_REQUIRED_PER_BYTE_SCHEMA=5e4,exports.MINIMUM_BALANCE_REQUIRED_PER_INT_SCHEMA_VALUE=28500,exports.OPT_IN_VALIDATOR_APP_PROCESS_TXN_COUNT=1,exports.OPT_OUT_VALIDATOR_APP_PROCESS_TXN_COUNT=1,exports.POOL_TOKEN_UNIT_NAME=tt,exports.REDEEM_PROCESS_TXN_COUNT=3,exports.RemoveLiquidity=yn,exports.Swap=Qn,exports.V1_1_ADD_LIQUIDITY_PROCESS_TXN_COUNT=5,exports.V1_1_REMOVE_LIQUIDITY_TXN_COUNT=Je,exports.V2AddLiquidityTxnIndices=xe,exports.V2_REMOVE_LIQUIDITY_APP_CALL_INNER_TXN_COUNT=2,exports.applySlippageToAmount=X,exports.calculateAccountMinimumRequiredBalance=yt,exports.convertFromBaseUnits=q,exports.convertToBaseUnits=G,exports.generateOptIntoAssetTxns=function(t){return et.apply(this,arguments)},exports.generateOptIntoValidatorTxns=function(t){return lt.apply(this,arguments)},exports.generateOptOutOfValidatorTxns=function(t){return dt.apply(this,arguments)},exports.generateRedeemTxns=function(t){return jn.apply(this,arguments)},exports.getAccountExcess=function(t){return wt.apply(this,arguments)},exports.getAccountExcessWithinPool=_t,exports.getAccountInformation=Tt,exports.getStakingAppID=function(t){return"testnet"===t?51948952:649588853},exports.getTxnGroupID=Z,exports.getValidatorAppID=pt,exports.hasSufficientMinimumBalance=function(t){return t.amount>=t.minimum_required_balance},exports.isAccountOptedIntoApp=function(t){var e=t.appID;return t.accountAppsLocalState.some((function(t){return t.id===e}))},exports.poolUtils=Gt,exports.prepareCommitTransactions=function(t){return Xn.apply(this,arguments)},exports.redeemAllExcessAsset=function(t){return Un.apply(this,arguments)},exports.redeemExcessAsset=function(t){return Ln.apply(this,arguments)},exports.sendAndWaitRawTransaction=Y,exports.sumUpTxnFees=W,exports.tinymanContract_v1_1=It,exports.tinymanContract_v2=gt;
