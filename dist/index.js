"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("algosdk"),t=require("base64-js");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),s=Uint8Array.from([1]);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var s=t&&t.prototype instanceof d?t:d,a=Object.create(s.prototype),o=new v(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(s,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===s)throw a;return b()}for(n.method=s,n.arg=a;;){var o=n.delegate;if(o){var i=y(o,n);if(i){if(i===l)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=p(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function d(){}function f(){}function A(){}var I={};u(I,s,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(N([])));m&&m!==t&&n.call(m,s)&&(I=m);var h=A.prototype=d.prototype=Object.create(I);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(s,a,o,i){var u=p(e[s],e,a);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,o,i)}),(function(e){r("throw",e,o,i)})):t.resolve(l).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,i)}))}i(u.arg)}var s;this._invoke=function(e,n){function a(){return new t((function(t,s){r(e,n,t,s)}))}return s=s?s.then(a,a):a()}}function y(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=p(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var s=r.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function v(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function N(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:b}}function b(){return{value:void 0,done:!0}}return f.prototype=A,u(h,"constructor",A),u(A,"constructor",f),f.displayName=u(A,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,u(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e},e.awrap=function(e){return{__await:e}},x(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,s,a){void 0===a&&(a=Promise);var o=new E(c(t,n,r,s),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(h),u(h,o,"Generator"),u(h,s,(function(){return this})),u(h,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=N,v.prototype={constructor:v,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var i=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(i&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var a=s;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var s=r.arg;D(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function u(e,t,n,r,s,a,o){try{var i=e[a](o),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,s)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function o(e){u(a,r,s,o,i,"next",e)}function i(e){u(a,r,s,o,i,"throw",e)}o(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h(e,t,n){return h=m()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var s=new(Function.bind.apply(e,r));return n&&g(s,n.prototype),s},h.apply(null,arguments)}function x(e){var t="function"==typeof Map?new Map:void 0;return x=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return h(e,arguments,I(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),g(r,e)},x(e)}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){var t=m();return function(){var n,r=I(e);if(t){var s=I(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return E(this,n)}}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,s,a=[],o=!0,i=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){i=!0,s=e}finally{try{o||null==n.return||n.return()}finally{if(i)throw s}}return a}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}var w="- would result negative",_="logic eval error:",S="exceeds schema integer count",k=/transaction \w+:/,B=function(e){A(n,x(Error));var t=y(n);function n(e,r){var s;p(this,n);for(var a=arguments.length,o=new Array(a>2?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];var u=(s=t.call.apply(t,[this].concat(o))).extractMessageFromAlgoSDKError(e);return s.data=e,s.type=s.getErrorType(u),s.setMessage(s.getErrorMessage(u,s.type,r)),s}return d(n,[{key:"setMessage",value:function(e){this.message=e}},{key:"getErrorType",value:function(e){var t="Unknown";return e.includes(w)?t="SlippageTolerance":e.includes(S)?t="ExceedingExcessAmountCount":e.includes(_)?t="LogicError":e.match(k)&&(t="TransactionError"),t}},{key:"getErrorMessage",value:function(e,t,n){var r;switch(t){case"SlippageTolerance":r="The process failed due to too much slippage in the price. Please adjust the slippage tolerance and try again.";break;case"ExceedingExcessAmountCount":r="The process failed due to the number of excess amounts accumulated for your account in the Tinyman app.";break;case"LogicError":r=e.split(_)[1];break;case"TransactionError":r=e.split(k)[1];break;case"Unknown":e&&(r=e)}return r||(r=n||"We encountered an unexpected error, try again later."),r.trim()}},{key:"extractMessageFromAlgoSDKError",value:function(e){var t,n,r,s="";return null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.body)&&void 0!==n&&n.message?s=e.response.body.message:null!=e&&null!==(r=e.response)&&void 0!==r&&r.text?s=e.response.text:"string"==typeof(null==e?void 0:e.message)&&(s=this.isMessageObjectString(null==e?void 0:e.message)?JSON.parse(e.message||"{message: ''}").message:e.message),"string"!=typeof s&&(s=String(s)),s}},{key:"isMessageObjectString",value:function(e){return"string"==typeof e&&e.includes("{message:")}}]),n}();function R(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={},r=b(t);try{for(r.s();!(e=r.n()).done;){var s=e.value,a=s.key,o=void 0;if(1==s.value.type)o=s.value.bytes;else{if(2!=s.value.type)throw new Error("Unexpected state type: ".concat(s.value.type));o=s.value.uint}n[atob(a)]=o}}catch(e){r.e(e)}finally{r.f()}return n}function P(e){var t,n=e.reduce((function(e,t){return e+t.length}),0),r=new Uint8Array(n),s=0,a=b(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;r.set(o,s),s+=o.length}}catch(e){a.e(e)}finally{a.f()}return r}var M=100000n,Q=100000n,O=100000n,C=25000n+25000n,U=25000n+3500n;function L(e){var t=e["apps-total-schema"],n=0n,r=0n;t&&(t["num-byte-slice"]&&(n=t["num-byte-slice"]),t["num-uint"]&&(r=t["num-uint"]));var s=e["apps-local-state"]||[],a=e["created-apps"]||[],o=e.assets||[];return M+Q*BigInt(o.length)+O*BigInt(a.length+s.length)+U*r+C*n}function j(e){return new Promise((function(t){setTimeout((function(){t(null)}),e)}))}function F(e,t){return V.apply(this,arguments)}function V(){return(V=c(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,j(1e3);case 3:return r=null,e.prev=4,e.next=7,t.pendingTransactionInformation(n).do();case 7:r=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:if(!r){e.next=17;break}if(!r["confirmed-round"]){e.next=15;break}return e.abrupt("return",r);case 15:if(!r["pool-error"]){e.next=17;break}throw new Error("Transaction Rejected: ".concat(r["pool-error"]));case 17:e.next=0;break;case 19:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}function J(e,t,n){if(t>1||t<0)throw new Error("Invalid slippage value. Must be between 0 and 1, got ".concat(t));var r;try{var s="negative"===e?1-t:1+t;r=BigInt(Math.floor(Number(n)*s))}catch(e){throw new Error(e.message)}return r}function X(e,t){var n=Number(e);return G({decimalPlaces:n},Math.pow(10,-n)*Number(t))}function G(e,t){var n=e.decimalPlaces,r=void 0===n?0:n;return Number(Math.round(Number(t+"e+".concat(r)))+"e-".concat(r))}function q(e,t){return z.apply(this,arguments)}function z(){return(z=c(i().mark((function e(t,n){var r,s,a,o,u,c,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=[],s=b(n),e.prev=3,s.s();case 5:if((a=s.n()).done){e.next=18;break}return o=a.value,e.next=9,t.sendRawTransaction(o).do();case 9:return u=e.sent,c=u.txId,e.next=13,F(t,c);case 13:p=e.sent,l=p["confirmed-round"],r.push({confirmedRound:l,txnID:c});case 16:e.next=5;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(3),s.e(e.t0);case 23:return e.prev=23,s.f(),e.finish(23);case 26:return e.abrupt("return",r);case 29:throw e.prev=29,e.t1=e.catch(0),new B(e.t1,"We encountered an error while processing this transaction. Try again later.");case 32:case"end":return e.stop()}}),e,null,[[0,29],[3,20,23,26]])})))).apply(this,arguments)}function Y(e){return e.reduce((function(e,t){return e+t.txn.fee}),0)}function W(e){return(t=e[0].txn.group)?Buffer.from(t).toString("base64"):"";var t}function Z(e){for(var t=[];;){var n=127&e;if(!(e>>=7)){t.push(n);break}t.push(128|n)}return t}function H(e){return(new TextEncoder).encode(e)}var K={id:"".concat(0),name:"Algorand",unit_name:"ALGO",decimals:6,url:"https://algorand.org",is_liquidity_token:!1,total_amount:"6615503326932151"},$={DEFAULT:"TMPOOL11",V1:"TM1POOL"};function ee(){return(ee=c(i().mark((function e(t){var n,s,a,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,s=t.assetID,a=t.initiatorAddr,e.prev=1,e.next=4,n.getTransactionParams().do();case 4:return o=e.sent,u=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:a,to:a,assetIndex:s,amount:0,suggestedParams:o}),e.abrupt("return",[{txn:u,signers:[a]}]);case 9:throw e.prev=9,e.t0=e.catch(1),new B(e.t0,"We encountered something unexpected while opting into this asset. Try again later.");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function te(e,t){var n=[e,t];return[Math.max.apply(Math,n),Math.min.apply(Math,n)]}function ne(e){return 0===Number(e)}var re,se={V1_1:"v1_1",V2:"v2"},ae={type:"logicsig",logic:{bytecode:"BCAIAQCBgICAgICAgPABgICAgICAgIDwAQMEBQYlJA1EMQkyAxJEMRUyAxJEMSAyAxJEMgQiDUQzAQAxABJEMwEQIQcSRDMBGIGCgICAgICAgPABEkQzARkiEjMBGyEEEhA3ARoAgAlib290c3RyYXASEEAAXDMBGSMSRDMBG4ECEjcBGgCABHN3YXASEEACOzMBGyISRDcBGgCABG1pbnQSQAE7NwEaAIAEYnVybhJAAZg3ARoAgAZyZWRlZW0SQAJbNwEaAIAEZmVlcxJAAnkAIQYhBSQjEk0yBBJENwEaARclEjcBGgIXJBIQRDMCADEAEkQzAhAhBBJEMwIhIxJEMwIiIxwSRDMCIyEHEkQzAiQjEkQzAiWACFRNUE9PTDExEkQzAiZRAA+AD1RpbnltYW5Qb29sMS4xIBJEMwIngBNodHRwczovL3RpbnltYW4ub3JnEkQzAikyAxJEMwIqMgMSRDMCKzIDEkQzAiwyAxJEMwMAMQASRDMDECEFEkQzAxElEkQzAxQxABJEMwMSIxJEJCMTQAAQMwEBMwIBCDMDAQg1AUIBsTMEADEAEkQzBBAhBRJEMwQRJBJEMwQUMQASRDMEEiMSRDMBATMCAQgzAwEIMwQBCDUBQgF8MgQhBhJENwEcATEAE0Q3ARwBMwQUEkQzAgAxABNEMwIUMQASRDMDADMCABJEMwIRJRJEMwMUMwMHMwMQIhJNMQASRDMDESMzAxAiEk0kEkQzBAAxABJEMwQUMwIAEkQzAQEzBAEINQFCAREyBCEGEkQ3ARwBMQATRDcBHAEzAhQSRDMDFDMDBzMDECISTTcBHAESRDMCADEAEkQzAhQzBAASRDMCESUSRDMDADEAEkQzAxQzAwczAxAiEk0zBAASRDMDESMzAxAiEk0kEkQzBAAxABNEMwQUMQASRDMBATMCAQgzAwEINQFCAJAyBCEFEkQ3ARwBMQATRDMCADcBHAESRDMCADEAE0QzAwAxABJEMwIUMwIHMwIQIhJNMQASRDMDFDMDBzMDECISTTMCABJEMwEBMwMBCDUBQgA+MgQhBBJENwEcATEAE0QzAhQzAgczAhAiEk03ARwBEkQzAQEzAgEINQFCABIyBCEEEkQzAQEzAgEINQFCAAAzAAAxABNEMwAHMQASRDMACDQBD0M=",address:"ABUKAXTANWR6K6ZYV75DWJEPVWWOU6SFUVRI6QHO44E4SIDLHBTD2CZ64A",size:881,variables:[{name:"TMPL_ASSET_ID_1",type:"int",index:15,length:10},{name:"TMPL_ASSET_ID_2",type:"int",index:5,length:10},{name:"TMPL_VALIDATOR_APP_ID",type:"int",index:74,length:10}],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/pool_logicsig.teal.tmpl"},name:"pool_logicsig"},oe={type:"app",approval_program:{bytecode:"BCAHAAHoB+UHBf///////////wHAhD0mDQFvAWUBcAJhMQJhMgJsdARzd2FwBG1pbnQBdAJjMQJwMQJjMgJwMjEZgQQSMRkhBBIRMRmBAhIRQATxMRkjEjEbIhIQQATjNhoAgAZjcmVhdGUSQATUMRkjEjYaAIAJYm9vdHN0cmFwEhBAA/MzAhIzAggINTQiK2I1ZSI0ZXAARDUBIicEYjVmNGZAABEiYCJ4CTEBCDMACAk1AkIACCI0ZnAARDUCIicFYjVnKDRlFlA1byI0b2I1PSg0ZhZQNXAiNHBiNT4oNGcWUDVxIjRxYjU/IipiNUA0ATQ9CTVHNAI0Pgk1SDEAKVA0ZRZQNXkxAClQNGYWUDV6MQApUDRnFlA1ezYaAIAGcmVkZWVtEkAAWjYaAIAEZmVlcxJAABw2GgAnBhI2GgAnBxIRNhoAgARidXJuEhFAAG0ANGdJRDMCERJEMwISRDMCFDIJEkQ0PzMCEgk1PzRAMwISCTVAIio0QGYiNHE0P2YjQzMCFDMCBzMCECMSTTYcARJENDREIigzAhEWUEpiNDQJZiMxAClQMwIRFlBKYjQ0CUlBAANmI0NIaCNDMgciJwhiCUk1+kEARiInCWIiJwpiNPodTEAANx4hBSMeHzX7SEhIIicLYiInDGI0+h1MQAAdHiEFIx4fNfxISEgiJwk0+2YiJws0/GYiJwgyB2YzAxIzAwgINTU2HAExABNENGdBACIiNGdwAEQ1BiIcNAYJND8INQQ2GgAnBhJAASA0ZzMEERJENhoAJwcSQABVNhwBMwQAEkQzBBI0Rx00BCMdH0hITEhJNRA0NAk1yTMEEjRIHTQEIx0fSEhMSEk1ETQ1CTXKNBA0ERBENEc0EAk1UTRINBEJNVI0BDMEEgk1U0ICCjYcATMCABJENEc0NAg1UTRINDUINVI0BCISQAAuNDQ0BB00RyMdH0hITEg0NTQEHTRIIx0fSEhMSEoNTUk0BAg1UzMEEgk1y0IBvyInBTMEEUk1Z2YoNGcWUDVxIjRncABERDRnNGUTRDRnNGYTRDMEEiQISR018DQ0NDUdNfFKDEAACBJENPA08Q5EMwQSJAgjCEkdNfA0NDQ1HTXxSg1AAAgSRDTwNPENRCQ1PzQEMwQSJAgINVNCAU82HAEzAgASRDMCETRlEjMDETRmEhBJNWRAABkzAhE0ZhIzAxE0ZRIQRDRINRI0RzUTQgAINEc1EjRINRM2GgGAAmZpEkAAWjYaAYACZm8SRDQ1JAs0Eh00EzQ1CSUdH0hITEgjCEk1FSINNDU0EwwQRDQ0NBUJNGRBABM1yTRHNBUINVE0SDQ1CTVSQgBnNco0SDQVCDVSNEc0NQk1UUIAVDQ0STUVJQs0Ex00EiQLNDQlCx4fSEhMSEk1FCINNBQ0EwwQRDQUNDUJNGRBABM1yjRHNDQINVE0SDQUCTVSQgATNck0RzQUCTVRNEg0NAg1UkIAADQVIQQLNAQdgaCcATQSHR9ISExISTUqNAQINVNCADsiKzYaARdJNWVmIicENhoCF0k1ZmY0ZXEDRIABLVCABEFMR080ZkEABkg0ZnEDRFAzAiZJFYEPTFISQyIqNEA0KghmIjRxND80Kgg0ywhmIjRvND00yQhmIjRwND40yghmIoACczE0UWYigAJzMjRSZiInCjRSIQYdNFEjHR9ISExIZiInDDRRIQYdNFIjHR9ISExIZiKAA2lsdDRTZjTLQQAJIzR7SmI0ywhmNMlBAAkjNHlKYjTJCGY0ykEACSM0ekpiNMoIZiNDI0MiQw==",address:"BUQHXHPLMYUVS3P2INJ2EUJFCSNT6LNUGXVM6T2SZ27TDRDYLUMWCFYW3E",size:1351,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_approval.teal"},clear_program:{bytecode:"BIEB",address:"P7GEWDXXW5IONRW6XRIRVPJCT2XXEQGOBGG65VJPBUOYZEJCBZWTPHS3VQ",size:3,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_clear_state.teal"},global_state_schema:{num_uints:0,num_byte_slices:0},local_state_schema:{num_uints:16,num_byte_slices:0},name:"validator_app"},ie=(f(re={},se.V1_1,{testnet:62368684,mainnet:552635992}),f(re,se.V2,{testnet:113134165,mainnet:552635992}),re);function ue(e,t){var n=ie[t][e];if(!n)throw new Error("No Validator App exists for ".concat(e," network with ").concat(t," contract version"));return n}function ce(){return(ce=c(i().mark((function e(t){var n,s,a,o,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,s=t.network,a=t.contractVersion,o=t.initiatorAddr,e.next=3,n.getTransactionParams().do();case 3:return u=e.sent,c=r.default.makeApplicationOptInTxnFromObject({from:o,appIndex:ue(s,a),suggestedParams:u}),e.abrupt("return",[{txn:c,signers:[o]}]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){return(pe=c(i().mark((function e(t){var n,s,a,o,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,s=t.network,a=t.contractVersion,o=t.initiatorAddr,e.next=3,n.getTransactionParams().do();case 3:return u=e.sent,c=r.default.makeApplicationClearStateTxnFromObject({from:o,appIndex:ue(s,a),suggestedParams:u}),e.abrupt("return",[{txn:c,signers:[o]}]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var le=d((function e(n){p(this,e),this.validatorApprovalContract=t.toByteArray(n.approval_program.bytecode),this.validatorClearStateContract=t.toByteArray(n.clear_program.bytecode),this.schema={numLocalInts:n.local_state_schema.num_uints,numLocalByteSlices:n.local_state_schema.num_byte_slices,numGlobalInts:n.global_state_schema.num_uints,numGlobalByteSlices:n.global_state_schema.num_byte_slices}})),de=new(function(n){A(s,le);var r=y(s);function s(e,t){var n;return p(this,s),(n=r.call(this,e)).poolLogicSigContractTemplate=t.logic.bytecode,n.templateVariables=t.logic.variables,n}return d(s,[{key:"generateLogicSigAccountForPool",value:function(n){if(n.asset1ID===n.asset2ID)throw new Error("Assets are the same");var r=ue(n.network,se.V1_1),s=T(te(n.asset1ID,n.asset2ID),2),a=s[0],o=s[1],i=Array.from(t.toByteArray(this.poolLogicSigContractTemplate)),u={asset_id_1:a,asset_id_2:o,validator_app_id:r},c=0;this.templateVariables.sort((function(e,t){return e.index-t.index}));for(var p=0;p<this.templateVariables.length;p++){var l=this.templateVariables[p],d=u[l.name.split("TMPL_")[1].toLowerCase()],f=l.index-c,A=f+l.length,I=Z(d);c+=l.length-I.length,i=i.slice(0,f).concat(I).concat(i.slice(A))}var g=new Uint8Array(i);return new e.LogicSigAccount(g)}}]),s}())(oe,ae),fe={type:"logicsig",logic:{bytecode:"BoAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgQBbNQA0ADEYEkQxGYEBEkSBAUM="},name:"pool_logicsig"},Ae={type:"app",approval_program:{bytecode:"BCAHAAHoB+UHBf///////////wHAhD0mDQFvAWUBcAJhMQJhMgJsdARzd2FwBG1pbnQBdAJjMQJwMQJjMgJwMjEZgQQSMRkhBBIRMRmBAhIRQATxMRkjEjEbIhIQQATjNhoAgAZjcmVhdGUSQATUMRkjEjYaAIAJYm9vdHN0cmFwEhBAA/MzAhIzAggINTQiK2I1ZSI0ZXAARDUBIicEYjVmNGZAABEiYCJ4CTEBCDMACAk1AkIACCI0ZnAARDUCIicFYjVnKDRlFlA1byI0b2I1PSg0ZhZQNXAiNHBiNT4oNGcWUDVxIjRxYjU/IipiNUA0ATQ9CTVHNAI0Pgk1SDEAKVA0ZRZQNXkxAClQNGYWUDV6MQApUDRnFlA1ezYaAIAGcmVkZWVtEkAAWjYaAIAEZmVlcxJAABw2GgAnBhI2GgAnBxIRNhoAgARidXJuEhFAAG0ANGdJRDMCERJEMwISRDMCFDIJEkQ0PzMCEgk1PzRAMwISCTVAIio0QGYiNHE0P2YjQzMCFDMCBzMCECMSTTYcARJENDREIigzAhEWUEpiNDQJZiMxAClQMwIRFlBKYjQ0CUlBAANmI0NIaCNDMgciJwhiCUk1+kEARiInCWIiJwpiNPodTEAANx4hBSMeHzX7SEhIIicLYiInDGI0+h1MQAAdHiEFIx4fNfxISEgiJwk0+2YiJws0/GYiJwgyB2YzAxIzAwgINTU2HAExABNENGdBACIiNGdwAEQ1BiIcNAYJND8INQQ2GgAnBhJAASA0ZzMEERJENhoAJwcSQABVNhwBMwQAEkQzBBI0Rx00BCMdH0hITEhJNRA0NAk1yTMEEjRIHTQEIx0fSEhMSEk1ETQ1CTXKNBA0ERBENEc0EAk1UTRINBEJNVI0BDMEEgk1U0ICCjYcATMCABJENEc0NAg1UTRINDUINVI0BCISQAAuNDQ0BB00RyMdH0hITEg0NTQEHTRIIx0fSEhMSEoNTUk0BAg1UzMEEgk1y0IBvyInBTMEEUk1Z2YoNGcWUDVxIjRncABERDRnNGUTRDRnNGYTRDMEEiQISR018DQ0NDUdNfFKDEAACBJENPA08Q5EMwQSJAgjCEkdNfA0NDQ1HTXxSg1AAAgSRDTwNPENRCQ1PzQEMwQSJAgINVNCAU82HAEzAgASRDMCETRlEjMDETRmEhBJNWRAABkzAhE0ZhIzAxE0ZRIQRDRINRI0RzUTQgAINEc1EjRINRM2GgGAAmZpEkAAWjYaAYACZm8SRDQ1JAs0Eh00EzQ1CSUdH0hITEgjCEk1FSINNDU0EwwQRDQ0NBUJNGRBABM1yTRHNBUINVE0SDQ1CTVSQgBnNco0SDQVCDVSNEc0NQk1UUIAVDQ0STUVJQs0Ex00EiQLNDQlCx4fSEhMSEk1FCINNBQ0EwwQRDQUNDUJNGRBABM1yjRHNDQINVE0SDQUCTVSQgATNck0RzQUCTVRNEg0NAg1UkIAADQVIQQLNAQdgaCcATQSHR9ISExISTUqNAQINVNCADsiKzYaARdJNWVmIicENhoCF0k1ZmY0ZXEDRIABLVCABEFMR080ZkEABkg0ZnEDRFAzAiZJFYEPTFISQyIqNEA0KghmIjRxND80Kgg0ywhmIjRvND00yQhmIjRwND40yghmIoACczE0UWYigAJzMjRSZiInCjRSIQYdNFEjHR9ISExIZiInDDRRIQYdNFIjHR9ISExIZiKAA2lsdDRTZjTLQQAJIzR7SmI0ywhmNMlBAAkjNHlKYjTJCGY0ykEACSM0ekpiNMoIZiNDI0MiQw==",address:"BUQHXHPLMYUVS3P2INJ2EUJFCSNT6LNUGXVM6T2SZ27TDRDYLUMWCFYW3E",size:1351,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_approval.teal"},clear_program:{bytecode:"BIEB",address:"P7GEWDXXW5IONRW6XRIRVPJCT2XXEQGOBGG65VJPBUOYZEJCBZWTPHS3VQ",size:3,variables:[],source:"https://github.com/tinymanorg/tinyman-contracts-v1/tree/dc9ab40c58b85c15d58f63a1507e18be76720dbb/contracts/validator_clear_state.teal"},global_state_schema:{num_uints:0,num_byte_slices:3},local_state_schema:{num_uints:12,num_byte_slices:2},name:"validator_app"},Ie=new(function(t){A(r,le);var n=y(r);function r(e,t){var s;return p(this,r),(s=n.call(this,e)).poolLogicSigContractTemplate=t.logic.bytecode,s}return d(r,[{key:"generateLogicSigAccountForPool",value:function(t){if(t.asset1ID===t.asset2ID)throw new Error("Assets are the same");var n=ue(t.network,se.V2),r=T(te(t.asset1ID,t.asset2ID),2),s=r[0],a=r[1],o={bytes:Array.from(Buffer.from(this.poolLogicSigContractTemplate,"base64")),validatorAppId:Array.from(e.encodeUint64(n)),asset1ID:Array.from(e.encodeUint64(s)),asset2ID:Array.from(e.encodeUint64(a))},i=[].concat(D(o.bytes.slice(0,3)),D(o.validatorAppId.slice(0,8)),D(o.asset1ID.slice(0,8)),D(o.asset2ID.slice(0,8)),D(o.bytes.slice(27)));return new e.LogicSigAccount(new Uint8Array(i))}}]),r}())(Ae,fe);function ge(e){return function(e){return e===se.V2}(e)?Ie:de}function me(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.IntDecoding.DEFAULT;return new Promise(function(){var e=c(i().mark((function e(s,a){var u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.accountInformation(n).setIntDecoding(r).do();case 3:u=e.sent,s(o(o({},u),{},{minimum_required_balance:xe(u)})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a(new Error(e.t0.message||"Failed to fetch account information"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}())}function he(e,t){var n=e["apps-local-state"].find((function(e){return e.id===t}));return n?R(n["key-value"]):null}function xe(e){var t=e["apps-total-schema"];return 1e5+1e5*(e.assets||[]).length+1e5*(e["created-apps"]||[]).length+1e5*(e["apps-local-state"]||[]).length+5e4*(t&&t["num-byte-slice"]||0)+28500*(t&&t["num-uint"]||0)+1e5*(e["apps-total-extra-pages"]||0)}var Ee,ye,Te=H("e");function De(e){return ve.apply(this,arguments)}function ve(){return(ve=c(i().mark((function n(s){var a,o,u,c,p,l,d,f,A,I,g,m,h,x,E,y,T,D,v,N,w;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=s.client,o=s.pool,u=s.accountAddr,n.next=3,a.accountInformation(u).setIntDecoding(e.IntDecoding.BIGINT).do();case 3:c=n.sent,p=c["apps-local-state"]||[],l=0n,d=0n,f=0n,A=o.account.address(),I=b(p),n.prev=10,I.s();case 12:if((g=I.n()).done){n.next=31;break}if((m=g.value).id==o.validatorAppID){n.next=16;break}return n.abrupt("continue",29);case 16:if(h=m["key-value"]){n.next=19;break}return n.abrupt("break",31);case 19:x=R(h),E=t.fromByteArray(P([r.default.decodeAddress(A).publicKey,Te,r.default.encodeUint64(o.asset1ID)])),y=t.fromByteArray(P([r.default.decodeAddress(A).publicKey,Te,r.default.encodeUint64(o.asset2ID)])),T=t.fromByteArray(P([r.default.decodeAddress(A).publicKey,Te,r.default.encodeUint64(o.liquidityTokenID)])),D=x[E],v=x[y],N=x[T],"bigint"==typeof D&&(l=D),"bigint"==typeof v&&(d=v),"bigint"==typeof N&&(f=N);case 29:n.next=12;break;case 31:n.next=36;break;case 33:n.prev=33,n.t0=n.catch(10),I.e(n.t0);case 36:return n.prev=36,I.f(),n.finish(36);case 39:if(!((w={excessAsset1:l,excessAsset2:d,excessLiquidityTokens:f}).excessAsset1<0n||w.excessAsset2<0n||w.excessLiquidityTokens<0n)){n.next=42;break}throw new Error("Invalid account excess: ".concat(w));case 42:return n.abrupt("return",w);case 43:case"end":return n.stop()}}),n,null,[[10,33,36,39]])})))).apply(this,arguments)}function Ne(){return(Ne=c(i().mark((function e(n){var s,a,o,u,c,p,l,d,f,A,I,g,m,h,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.client,a=n.accountAddr,o=n.validatorAppID,e.next=3,s.accountInformation(a).setIntDecoding("bigint").do();case 3:if(u=e.sent,c=u["apps-local-state"]||[],p=c.find((function(e){return e.id==o})),l=[],p&&p["key-value"])for(d=R(p["key-value"]),f=0,A=Object.entries(d);f<A.length;f++)I=A[f],g=T(I,2),m=g[0],h=g[1],41===(x=t.toByteArray(m)).length&&101===x[32]&&l.push({poolAddress:r.default.encodeAddress(x.slice(0,32)),assetID:r.default.decodeUint64(x.slice(33,41),"safe"),amount:parseInt(h)});return e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.NOT_CREATED="not created",e.BOOTSTRAP="bootstrap",e.READY="ready",e.ERROR="error"}(Ee||(Ee={}));var be=(f(ye={},se.V1_1,{asset1:"a1",asset2:"a2"}),f(ye,se.V2,{asset1:"asset_1_id",asset2:"asset_2_id",liquidityTokenID:"pool_token_asset_id",issuedPoolTokens:"issued_pool_tokens",asset1Reserves:"asset_1_reserves",asset2Reserves:"asset_2_reserves",asset1ProtocolFees:"asset_1_protocol_fees",asset2ProtocolFees:"asset_2_protocol_fees",totalFeeShare:"total_fee_share",protocolFeeRatio:"protocol_fee_ratio",cumulativePriceUpdateTimeStamp:"cumulative_price_update_timestamp"}),ye),we=H("o"),_e=0xffffffffffffffffn;function Se(e){return ke.apply(this,arguments)}function ke(){return(ke=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d,f,A,I,g;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.client,s=t.network,a=t.asset1ID,o=t.asset2ID,u=ge(se.V1_1),c=u.generateLogicSigAccountForPool(t),p=ue(s,se.V1_1),l=c.address(),d=te(a,o),e.next=8,me(r,l);case 8:return f=e.sent,A=he(f,p),I=null===(n=f["created-assets"][0])||void 0===n?void 0:n.index,g={account:c,validatorAppID:p,asset1ID:d[0],asset2ID:d[1],status:A||I?Ee.READY:Ee.NOT_CREATED,contractVersion:se.V1_1,liquidityTokenID:I},A&&(g.asset1ID=A[be.v1_1.asset1],g.asset2ID=A[be.v1_1.asset2]),e.abrupt("return",g);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(){return(Be=c(i().mark((function n(s,a){var o,u,c,p,l,d,f,A,I,g,m,h,x,E,y,T,D,v,N,w,_,S,k,B,M,Q;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,me(s,a.account.address(),e.IntDecoding.BIGINT);case 2:o=n.sent,u=o["apps-local-state"]||[],c=0n,p=0n,l=0n,d=b(u),n.prev=8,d.s();case 10:if((f=d.n()).done){n.next=29;break}if((A=f.value).id==a.validatorAppID){n.next=14;break}return n.abrupt("continue",27);case 14:if(I=A["key-value"]){n.next=17;break}return n.abrupt("break",29);case 17:g=R(I),m=t.fromByteArray(P([we,r.default.encodeUint64(a.asset1ID)])),h=t.fromByteArray(P([we,r.default.encodeUint64(a.asset2ID)])),x=t.fromByteArray(P([we,r.default.encodeUint64(a.liquidityTokenID)])),E=g[m],y=g[h],T=g[x],"bigint"==typeof E&&(c=E),"bigint"==typeof y&&(p=y),"bigint"==typeof T&&(l=T);case 27:n.next=10;break;case 29:n.next=34;break;case 31:n.prev=31,n.t0=n.catch(8),d.e(n.t0);case 34:return n.prev=34,d.f(),n.finish(34);case 37:D=0n,v=0n,N=0n,w=b(o.assets);try{for(w.s();!(_=w.n()).done;)S=_.value,k=S["asset-id"],B=S.amount,k==a.asset1ID?D=BigInt(B):k==a.asset2ID?v=BigInt(B):k==a.liquidityTokenID&&(N=BigInt(B))}catch(e){w.e(e)}finally{w.f()}if(0===a.asset2ID&&(M=L(o),v=BigInt(o.amount)-M),!((Q={asset1:D-c,asset2:v-p,issuedLiquidity:_e-N+l,round:o.round}).asset1<0n||Q.asset2<0n||Q.issuedLiquidity<0n||Q.issuedLiquidity>_e)){n.next=49;break}throw Q.asset1=Number(Q.asset1),Q.asset2=Number(Q.asset2),Q.issuedLiquidity=Number(Q.issuedLiquidity),new Error("Invalid pool reserves: ".concat(JSON.stringify(Q)));case 49:return n.abrupt("return",Q);case 50:case"end":return n.stop()}}),n,null,[[8,31,34,37]])})))).apply(this,arguments)}function Re(){return Re=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,r=t.address,s=t.network,!(a=d.length>1&&void 0!==d[1]?d[1]:{})[r]){e.next=4;break}return e.abrupt("return",a[r]);case 4:return e.next=6,me(n,r);case 6:return o=e.sent,u=he(o,ue(s,se.V1_1)),c=null,u&&(l=o["created-assets"][0],p=l.index,c={asset1ID:u[be[se.V1_1].asset1],asset2ID:u[be[se.V1_1].asset2],liquidityTokenID:p},a[r]=c),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)}))),Re.apply(this,arguments)}var Pe=Object.freeze({__proto__:null,getPoolInfo:Se,getPoolReserves:function(e,t){return Be.apply(this,arguments)},getPoolAssets:function(e){return Re.apply(this,arguments)}});function Me(e){return Qe.apply(this,arguments)}function Qe(){return(Qe=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d,f,A;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.network,s=t.asset1ID,a=t.asset2ID,o=ge(se.V2),u=o.generateLogicSigAccountForPool(t),c=ue(r,se.V2),p=u.address(),l=te(s,a),e.next=8,me(n,p);case 8:return d=e.sent,f=he(d,c),A={account:u,validatorAppID:c,asset1ID:l[0],asset2ID:l[1],status:f?Ee.READY:Ee.NOT_CREATED,contractVersion:se.V2},f&&(A.asset1ProtocolFees=BigInt(f[be.v2.asset1ProtocolFees]),A.asset2ProtocolFees=BigInt(f[be.v2.asset2ProtocolFees]),A.asset1Reserves=BigInt(f[be.v2.asset1Reserves]),A.asset2Reserves=BigInt(f[be.v2.asset2Reserves]),A.issuedPoolTokens=BigInt(f[be.v2.issuedPoolTokens]),A.cumulativePriceUpdateTimeStamp=Number(f[be.v2.cumulativePriceUpdateTimeStamp]),A.protocolFeeRatio=Number(f[be.v2.protocolFeeRatio]),A.totalFeeShare=BigInt(f[be.v2.totalFeeShare]),A.liquidityTokenID=Number(f[be.v2.liquidityTokenID]),A.asset1ID=Number(f[be.v2.asset1]),A.asset2ID=Number(f[be.v2.asset2])),e.abrupt("return",A);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(){return(Oe=c(i().mark((function e(t,n){var r,s,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(t,n.account.address());case 2:return r=e.sent,s=he(r,n.validatorAppID),a={asset1:0n,asset2:0n,issuedLiquidity:0n,round:r.round},s&&(a.asset1=BigInt(s[be.v2.asset1Reserves]),a.asset2=BigInt(s[be.v2.asset2Reserves]),a.issuedLiquidity=BigInt(s[be.v2.issuedPoolTokens])),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){return(Ce=c(i().mark((function e(t){var n,r,s,a,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.address,s=t.network,e.next=3,me(n,r);case 3:return a=e.sent,o=he(a,ue(s,se.V2)),u=null,o&&(u={asset1ID:o[be[se.V2].asset1],asset2ID:o[be[se.V2].asset2],liquidityTokenID:o[be[se.V2].liquidityTokenID]}),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue=Object.freeze({__proto__:null,getPoolInfo:Me,getPoolReserves:function(e,t){return Oe.apply(this,arguments)},getPoolAssets:function(e){return Ce.apply(this,arguments)}});function Le(e){return Boolean(e&&!(e.asset1+e.asset2))}var je,Fe,Ve,Je=Object.freeze({__proto__:null,getPoolShare:function(e,t){var n=Number(t)/Number(e);return Number.isFinite(n)||(n=0),n},getPoolPairRatio:function(e,t){var n=Le(t),r=null;return t&&!n&&t.asset1&&t.asset2&&"number"==typeof e.asset2&&"number"==typeof e.asset1&&(r=X(e.asset1,t.asset1)/X(e.asset2,t.asset2)),r},isPoolEmpty:Le,isPoolNotCreated:function(e){return(null==e?void 0:e.status)===Ee.NOT_CREATED},isPoolReady:function(e){return(null==e?void 0:e.status)===Ee.READY},getPoolsForPair:function(e){return Promise.all([Se(e),Me(e)])}}),Xe=o((f(je={},se.V1_1,o(o({},Pe),Je)),f(je,se.V2,o(o({},Ue),Je)),je),Je);function Ge(e,t){return 3e5+(0===e?0:1e5)+1e5+28500*de.schema.numLocalInts+5e4*de.schema.numLocalByteSlices+t.liquidityTokenCreateTxn+t.asset1OptinTxn+t.asset2OptinTxn+t.validatorAppCallTxn}function qe(){return(qe=c(i().mark((function e(t){var n,s,a,o,u,c,p,l,d,f,A,I,g,m,h,x,E,y,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,s=t.validatorAppID,a=t.asset1ID,o=t.asset2ID,u=t.asset1UnitName,c=t.asset2UnitName,p=t.initiatorAddr,e.next=3,n.getTransactionParams().do();case 3:return l=e.sent,d=a>o?{asset1:{id:a,unitName:u},asset2:{id:o,unitName:c}}:{asset1:{id:o,unitName:c},asset2:{id:a,unitName:u}},f=de.generateLogicSigAccountForPool({asset1ID:d.asset1.id,asset2ID:d.asset2.id,network:"testnet"}),A=f.address(),I=r.default.makeApplicationOptInTxnFromObject({from:A,appIndex:s,appArgs:[H("bootstrap"),r.default.encodeUint64(d.asset1.id),r.default.encodeUint64(d.asset2.id)],foreignAssets:0==d.asset2.id?[d.asset1.id]:[d.asset1.id,d.asset2.id],suggestedParams:l}),g=r.default.makeAssetCreateTxnWithSuggestedParamsFromObject({from:A,total:0xffffffffffffffffn,decimals:6,defaultFrozen:!1,unitName:$.DEFAULT,assetName:"TinymanPool1.1 ".concat(d.asset1.unitName,"-").concat(d.asset2.unitName),assetURL:"https://tinyman.org",suggestedParams:l}),m=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:A,to:A,assetIndex:d.asset1.id,amount:0,suggestedParams:l}),h=0===d.asset2.id?null:r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:A,to:A,assetIndex:d.asset2.id,amount:0,suggestedParams:l}),x=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:p,to:A,amount:Ge(d.asset2.id,{liquidityTokenCreateTxn:g.fee,asset1OptinTxn:m.fee,asset2OptinTxn:h?h.fee:0,validatorAppCallTxn:I.fee}),suggestedParams:l}),E=[x,I,g,m],h&&E.push(h),y=r.default.assignGroupID(E),T=[{txn:y[0],signers:[p]},{txn:y[1],signers:[A]},{txn:y[2],signers:[A]},{txn:y[3],signers:[A]}],y[4]&&T.push({txn:y[4],signers:[A]}),e.abrupt("return",T);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(){return(ze=c(i().mark((function e(t){var n,s,a,o,u,c,p,l,d,f,A;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txGroup,s=t.initiatorSigner,a=t.asset1ID,o=t.asset2ID,e.next=3,s([n]);case 3:return u=e.sent,c=T(u,1),p=c[0],l=a>o?{asset1ID:a,asset2ID:o}:{asset1ID:o,asset2ID:a},d=de.generateLogicSigAccountForPool({asset1ID:l.asset1ID,asset2ID:l.asset2ID,network:"testnet"}),f=[],A=n.map((function(e,t){if(t===Fe.FUNDING_TXN)return f.push(e.txn.txID().toString()),p;var n=r.default.signLogicSigTransactionObject(e.txn,d),s=n.txID,a=n.blob;return f.push(s),a})),e.abrupt("return",{signedTxns:A,txnIDs:f});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(e){return We.apply(this,arguments)}function We(){return(We=c(i().mark((function e(t){var n,r,s,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.signedTxns,s=t.txnIDs,e.prev=1,e.next=4,n.sendRawTransaction(r).do();case 4:return e.next=6,F(n,s[Fe.LIQUIDITY_TOKEN_CREATE]);case 6:if(a=e.sent,"number"==typeof(o=a["asset-index"])){e.next=10;break}throw new Error("Generated ID is not valid: got ".concat(o));case 10:return e.abrupt("return",{liquidityTokenID:o});case 13:throw e.prev=13,e.t0=e.catch(1),new B(e.t0,"We encountered something unexpected while bootstraping the pool. Try again later.");case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function Ze(){return(Ze=c(i().mark((function e(t,n,r,s){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye({client:t,signedTxns:r,txnIDs:s});case 2:return e.abrupt("return",Xe.v1_1.getPoolInfo({client:t,network:"testnet",asset1ID:n.asset1ID,asset2ID:n.asset2ID}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e[e.FUNDING_TXN=0]="FUNDING_TXN",e[e.VALIDATOR_APP_CALL=1]="VALIDATOR_APP_CALL",e[e.LIQUIDITY_TOKEN_CREATE=2]="LIQUIDITY_TOKEN_CREATE",e[e.ASSET1_OPT_IN=3]="ASSET1_OPT_IN",e[e.ASSET2_OPT_IN=4]="ASSET2_OPT_IN"}(Fe||(Fe={}));var He,Ke,$e,et=H("add_liquidity"),tt=1,nt=2,rt=2,st=(f(Ve={},se.V1_1,[H("mint")]),f(Ve,se.V2,{INITIAL_LIQUIDITY:[H("add_initial_liquidity")],SINGLE_ASSET_MODE:[et,H("single")],FLEXIBLE_MODE:[et,H("flexible")]}),Ve);!function(e){e[e.FEE_TXN=0]="FEE_TXN",e[e.VALIDATOR_APP_CALL_TXN=1]="VALIDATOR_APP_CALL_TXN",e[e.ASSET1_IN_TXN=2]="ASSET1_IN_TXN",e[e.ASSET2_IN_TXN=3]="ASSET2_IN_TXN",e[e.LIQUDITY_OUT_TXN=4]="LIQUDITY_OUT_TXN"}(Ke||(Ke={})),function(e){e.SINGLE="single",e.FLEXIBLE="flexible",e.INITIAL="initial"}($e||($e={}));var at=(f(He={},$e.FLEXIBLE,{ASSET1_IN_TXN:0,ASSET2_IN_TXN:1,VALIDATOR_APP_CALL_TXN:2}),f(He,$e.SINGLE,{ASSET_IN_TXN:0,VALIDATOR_APP_CALL_TXN:1}),f(He,$e.INITIAL,{ASSET1_IN_TXN:0,ASSET2_IN_TXN:1,VALIDATOR_APP_CALL_TXN:2}),He);function ot(){return(ot=c(i().mark((function e(t){var n,a,o,u,c,p,l,d,f,A,I,g,m,h,x,E;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,a=t.network,o=t.poolAddress,u=t.asset_1,c=t.asset_2,p=t.liquidityToken,l=t.slippage,d=t.initiatorAddr,f=J("negative",l,p.amount),e.next=4,n.getTransactionParams().do();case 4:return A=e.sent,I=r.default.makeApplicationNoOpTxnFromObject({from:o,appIndex:ue(a,se.V1_1),appArgs:st.v1_1,accounts:[d],foreignAssets:0==c.id?[u.id,p.id]:[u.id,c.id,p.id],suggestedParams:A}),g=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:o,assetIndex:u.id,amount:u.amount,suggestedParams:A}),m=0===c.id?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:o,amount:c.amount,suggestedParams:A}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:o,assetIndex:c.id,amount:c.amount,suggestedParams:A}),h=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:o,to:d,assetIndex:p.id,amount:f,suggestedParams:A}),x=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:o,amount:I.fee+h.fee,note:s,suggestedParams:A}),E=r.default.assignGroupID([x,I,g,m,h]),e.abrupt("return",[{txn:E[0],signers:[d]},{txn:E[1],signers:[o]},{txn:E[2],signers:[d]},{txn:E[3],signers:[d]},{txn:E[4],signers:[o]}]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function it(){return(it=c(i().mark((function e(t){var n,s,a,o,u,c,p,l,d,f;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pool,s=t.txGroup,a=t.initiatorSigner,o=n.account,e.next=4,a([s]);case 4:return u=e.sent,c=T(u,3),p=c[0],l=c[1],d=c[2],f=s.map((function(e,t){return t===Ke.FEE_TXN?p:t===Ke.ASSET1_IN_TXN?l:t===Ke.ASSET2_IN_TXN?d:r.default.signLogicSigTransactionObject(e.txn,o).blob})),e.abrupt("return",f);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(){return(ut=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d,f,A,I,g,m,h,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,s=t.txGroup,a=t.signedTxns,o=t.initiatorAddr,e.prev=1,u=BigInt(s[Ke.LIQUDITY_OUT_TXN].txn.amount),e.next=5,De({client:n,pool:r,accountAddr:o});case 5:return c=e.sent,e.next=8,q(n,[a]);case 8:return p=e.sent,l=T(p,1),d=l[0],f=d.confirmedRound,A=d.txnID,I=Y(s),g=W(s),e.next=17,De({client:n,pool:r,accountAddr:o});case 17:return m=e.sent,(h=m.excessLiquidityTokens-c.excessLiquidityTokens)<0n&&(h=0n),e.abrupt("return",{round:f,fees:I,liquidityID:r.liquidityTokenID,liquidityOut:u+h,excessAmount:{excessAmountForMinting:h,totalExcessAmount:m.excessLiquidityTokens},txnID:A,groupID:g});case 23:throw e.prev=23,e.t0=e.catch(1),"SlippageTolerance"===(x=new B(e.t0,"We encountered something unexpected while minting liquidity. Try again later.")).type&&x.setMessage("Minting failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),x;case 28:case"end":return e.stop()}}),e,null,[[1,23]])})))).apply(this,arguments)}var ct=Object.freeze({__proto__:null,getQuote:function(e){var t=e.pool,n=e.reserves,r=e.asset1In,s=e.asset2In;if(0n===n.issuedLiquidity){var a=BigInt(Math.floor(Math.sqrt(Number(r)*Number(s))));if(a<=BigInt(1e3))throw new Error("Initial liquidity mint too small. Liquidity minting amount must be greater than ".concat(1e3,", this quote is for ").concat(a,"."));return{round:n.round,asset1ID:t.asset1ID,asset1In:BigInt(r),asset2ID:t.asset2ID,asset2In:BigInt(s),liquidityID:t.liquidityTokenID,liquidityOut:a-BigInt(1e3),share:1}}var o=BigInt(r)*n.issuedLiquidity/n.asset1,i=BigInt(s)*n.issuedLiquidity/n.asset2,u=o<i?o:i;return{round:n.round,asset1ID:t.asset1ID,asset1In:BigInt(r),asset2ID:t.asset2ID,asset2In:BigInt(s),liquidityID:t.liquidityTokenID,liquidityOut:u,share:Xe.getPoolShare(n.issuedLiquidity+u,u)}},generateTxns:function(e){return ot.apply(this,arguments)},signTxns:function(e){return it.apply(this,arguments)},execute:function(e){return ut.apply(this,arguments)}});function pt(e,t,n,r){var s,a,o,i,u,c,p,l,d,f,A=e.asset1*e.asset2,I=e.asset1+BigInt(n),g=e.asset2+BigInt(r),m=I*g,h=BigInt(parseInt(String(Math.sqrt(Number(m*e.issuedLiquidity*e.issuedLiquidity/A))))),x=h-e.issuedLiquidity,E=x*I/h,y=x*g/h,T=BigInt(n)-E,D=BigInt(r)-y;if(T>D){var v=T;o=BigInt(Math.abs(Math.min(Number(D),0))),s=!0,a=v+(i=lt(v,t)),x-=i*h/(I*BigInt(2))}else{var N=D;o=BigInt(Math.abs(Math.min(Number(T),0))),s=!1,a=N+(i=lt(N,t)),x-=i*h/(g*BigInt(2))}return{poolTokenAssetAmount:x,swapFromAsset1ToAsset2:s,swapInAmount:a,swapOutAmount:o,swapTotalFeeAmount:i,swapPriceImpact:(u=s?e.asset1:e.asset2,c=s?e.asset2:e.asset1,p=a,l=X(6,o)/X(6,p),d=X(6,c)/X(6,u),f=l/d,BigInt(Math.abs(Math.round(f-1))))}}function lt(e,t){return e*BigInt(t)/(BigInt(1e4)-BigInt(t))}function dt(e){var t=e.txGroup;return(0,e.initiatorSigner)([t])}function ft(e){return At.apply(this,arguments)}function At(){return(At=c(i().mark((function t(n){var r,s,a,o,u,c,p,l,d,f,A,I,g,m,h,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,s=n.pool,a=n.txGroup,o=n.signedTxns,u=n.mode,t.prev=1,t.next=4,q(r,[o]);case 4:return c=t.sent,p=T(c,1),l=p[0],d=l.confirmedRound,f=l.txnID,A=a[at[u].VALIDATOR_APP_CALL_TXN].txn.txID(),t.next=12,e.waitForConfirmation(r,A,1e3);case 12:return I=t.sent,g=I["inner-txns"].find((function(e){return"axfer"===e.txn.txn.type})).txn.txn,m=Y(a),h=W(a),t.abrupt("return",{round:d,assetOut:{amount:g.aamt,assetID:g.xaid},fees:m,liquidityID:s.liquidityTokenID,txnID:f,groupID:h});case 19:throw t.prev=19,t.t0=t.catch(1),"SlippageTolerance"===(x=new B(t.t0,"We encountered something unexpected while minting liquidity. Try again later.")).type&&x.setMessage("Minting failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),x;case 24:case"end":return t.stop()}}),t,null,[[1,19]])})))).apply(this,arguments)}function It(){return(It=c(i().mark((function t(n){var s,a,u,c,p,l,d,f,A,I,g,m,h,x,E;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.client,a=n.network,u=n.poolAddress,c=n.asset_1,p=n.pool,l=n.asset_2,d=n.liquidityToken,f=n.initiatorAddr,A=n.minPoolTokenAssetAmount,t.next=3,s.getTransactionParams().do();case 3:return I=t.sent,g=ne(l.id),m=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:u,assetIndex:p.asset1ID,amount:c.amount,suggestedParams:I}),h=g?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:f,to:u,amount:l.amount,suggestedParams:I}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:u,assetIndex:p.asset2ID,amount:l.amount,suggestedParams:I}),x=r.default.makeApplicationNoOpTxnFromObject({from:f,appIndex:ue(a,se.V2),appArgs:[].concat(D(st.v2.FLEXIBLE_MODE),[e.encodeUint64(A)]),accounts:[u],foreignAssets:[d.id],suggestedParams:o(o({},I),{},{fee:(rt+1)*e.ALGORAND_MIN_TX_FEE})}),E=r.default.assignGroupID([m,h,x]),t.abrupt("return",[{txn:E[0],signers:[f]},{txn:E[1],signers:[f]},{txn:E[2],signers:[f]}]);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var gt=Object.freeze({__proto__:null,getQuote:function(e){var t=e.pool,n=e.reserves,r=e.asset1In,s=e.asset2In,a=e.slippage,o=void 0===a?.05:a;if(0n===n.issuedLiquidity)throw new Error("Pool has no liquidity");if(t.status!==Ee.READY)throw new Error("Pool is not ready");var i=pt(n,t.totalFeeShare,r,s),u=i.poolTokenAssetAmount,c=i.swapInAmount,p=i.swapOutAmount,l=i.swapPriceImpact,d={amountIn:c,amountOut:p,swapFees:i.swapTotalFeeAmount,priceImpact:l},f=u-BigInt(Math.ceil(Number(u)*o));return{asset1ID:t.asset1ID,asset2ID:t.asset2ID,asset1In:BigInt(r),asset2In:BigInt(s),liquidityOut:u,liquidityID:t.liquidityTokenID,round:n.round,share:Xe.getPoolShare(n.issuedLiquidity+p,p),slippage:o,swapQuote:d,minPoolTokenAssetAmountWithSlippage:f}},generateTxns:function(e){return It.apply(this,arguments)},signTxns:dt,execute:ft});function mt(){return(mt=c(i().mark((function t(n){var s,a,u,c,p,l,d,f,A,I,g,m,h,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.client,a=n.network,u=n.poolAddress,c=n.asset_1,p=n.asset_2,l=n.liquidityToken,d=n.initiatorAddr,f=n.minPoolTokenAssetAmount,!Boolean(c.amount)||!Boolean(p.amount)){t.next=3;break}throw new Error("If you want to add asset 1 and asset 2 at the same time, please use flexible add liquidity.");case 3:if(!c.amount){t.next=7;break}A=c,t.next=12;break;case 7:if(!p.amount){t.next=11;break}A=p,t.next=12;break;case 11:throw new Error("Please provide at least one asset amount to add liquidity.");case 12:return I=ne(A.id),t.next=15,s.getTransactionParams().do();case 15:return g=t.sent,m=I?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:u,amount:A.amount,suggestedParams:g}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:u,assetIndex:A.id,amount:A.amount,suggestedParams:g}),h=r.default.makeApplicationNoOpTxnFromObject({from:d,appIndex:ue(a,se.V2),appArgs:[].concat(D(st.v2.SINGLE_ASSET_MODE),[e.encodeUint64(f)]),accounts:[u],foreignAssets:[l.id],suggestedParams:o(o({},g),{},{fee:(nt+1)*e.ALGORAND_MIN_TX_FEE})}),x=r.default.assignGroupID([m,h]),t.abrupt("return",[{txn:x[0],signers:[d]},{txn:x[1],signers:[d]}]);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ht=Object.freeze({__proto__:null,getQuote:function(e){var t=e.pool,n=e.reserves,r=e.assetIn,s=e.slippage,a=void 0===s?.05:s;if(0n===n.issuedLiquidity)throw new Error("Pool has no liquidity");if(t.status!==Ee.READY)throw new Error("Pool is not ready");var o=r.id===t.asset1ID,i=pt(n,t.totalFeeShare,o?r.amount:0,o?0:r.amount),u=i.poolTokenAssetAmount,c=i.swapInAmount,p=i.swapOutAmount,l=i.swapPriceImpact,d={amountIn:c,amountOut:p,swapFees:i.swapTotalFeeAmount,priceImpact:l},f=u-BigInt(Math.ceil(Number(u)*a));return{asset1ID:t.asset1ID,asset2ID:t.asset2ID,assetIn:BigInt(r.amount),liquidityOut:u,liquidityID:t.liquidityTokenID,round:n.round,share:Xe.getPoolShare(n.issuedLiquidity+p,p),slippage:a,swapQuote:d,minPoolTokenAssetAmountWithSlippage:f}},generateTxns:function(e){return mt.apply(this,arguments)},signTxns:dt,execute:ft});function xt(){return(xt=c(i().mark((function t(n){var s,a,u,c,p,l,d,f,A,I,g,m,h,x;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.client,a=n.pool,u=n.network,c=n.poolAddress,p=n.asset_1,l=n.asset_2,d=n.liquidityToken,f=n.initiatorAddr,A=ne(a.asset2ID),t.next=4,s.getTransactionParams().do();case 4:return I=t.sent,g=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:c,assetIndex:a.asset1ID,amount:p.amount,suggestedParams:I}),m=A?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:f,to:c,amount:l.amount,suggestedParams:I}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:c,assetIndex:a.asset2ID,amount:l.amount,suggestedParams:I}),h=r.default.makeApplicationNoOpTxnFromObject({from:f,appIndex:ue(u,se.V2),appArgs:st.v2.INITIAL_LIQUIDITY,accounts:[c],foreignAssets:[d.id],suggestedParams:o(o({},I),{},{fee:(tt+1)*e.ALGORAND_MIN_TX_FEE})}),x=r.default.assignGroupID([g,m,h]),t.abrupt("return",[{txn:x[0],signers:[f]},{txn:x[1],signers:[f]},{txn:x[2],signers:[f]}]);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Et,yt,Tt=Object.freeze({__proto__:null,getQuote:function(e){var t=e.pool,n=e.reserves,r=e.asset1In,s=e.asset2In,a=e.slippage,o=void 0===a?.05:a;if(0n!==n.issuedLiquidity)throw new Error("Pool already has liquidity");var i=function(e,t){if(!e||!t)throw new Error("Both assets are required for the initial add liquidity");return BigInt(Math.sqrt(Number(e)*Number(t))-1e3)}(r,s);return{asset1ID:t.asset1ID,asset2ID:t.asset2ID,asset1In:BigInt(r),asset2In:BigInt(s),poolTokenAssetAmount:i,slippage:o}},generateTxns:function(e){return xt.apply(this,arguments)},signTxns:dt,execute:ft}),Dt=Object.freeze({__proto__:null,flexible:gt,withSingleAsset:ht,initial:Tt}),vt=(f(Et={},se.V1_1,ct),f(Et,se.V2,Dt),Et);!function(e){e[e.FEE_TXN=0]="FEE_TXN",e[e.VALIDATOR_APP_CALL_TXN=1]="VALIDATOR_APP_CALL_TXN",e[e.ASSET1_OUT_TXN=2]="ASSET1_OUT_TXN",e[e.ASSET2_OUT_TXN=3]="ASSET2_OUT_TXN",e[e.LIQUDITY_IN_TXN=4]="LIQUDITY_IN_TXN"}(yt||(yt={}));function Nt(){return(Nt=c(i().mark((function e(t){var n,a,o,u,c,p,l,d,f,A,I,g,m,h,x,E,y,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,a=t.pool,o=t.liquidityIn,u=t.asset1Out,c=t.asset2Out,p=t.slippage,l=t.initiatorAddr,e.next=3,n.getTransactionParams().do();case 3:return d=e.sent,f=a.account.address(),A=r.default.makeApplicationNoOpTxnFromObject({from:f,appIndex:a.validatorAppID,appArgs:[H("burn")],accounts:[l],foreignAssets:0==a.asset2ID?[a.asset1ID,a.liquidityTokenID]:[a.asset1ID,a.asset2ID,a.liquidityTokenID],suggestedParams:d}),I=J("negative",p,u),g=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:l,assetIndex:a.asset1ID,amount:I,suggestedParams:d}),m=J("negative",p,c),h=0===a.asset2ID?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:f,to:l,amount:m,suggestedParams:d}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:f,to:l,assetIndex:a.asset2ID,amount:m,suggestedParams:d}),x=r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:l,to:f,assetIndex:a.liquidityTokenID,amount:o,suggestedParams:d}),E=A.fee+g.fee+h.fee,y=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:f,amount:E,note:s,suggestedParams:d}),E+=x.fee+y.fee,T=r.default.assignGroupID([y,A,g,h,x]),e.abrupt("return",[{txn:T[yt.FEE_TXN],signers:[l]},{txn:T[yt.VALIDATOR_APP_CALL_TXN],signers:[f]},{txn:T[yt.ASSET1_OUT_TXN],signers:[f]},{txn:T[yt.ASSET2_OUT_TXN],signers:[f]},{txn:T[yt.LIQUDITY_IN_TXN],signers:[l]}]);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(){return(bt=c(i().mark((function e(t){var n,s,a,o,u,c,p,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pool,s=t.txGroup,a=t.initiatorSigner,e.next=3,a([s]);case 3:return o=e.sent,u=T(o,2),c=u[0],p=u[1],l=n.account,d=s.map((function(e,t){return t===yt.FEE_TXN?c:t===yt.LIQUDITY_IN_TXN?p:r.default.signLogicSigTransactionObject(e.txn,l).blob})),e.abrupt("return",d);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(){return(wt=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d,f,A,I,g,m,h,x,E;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,s=t.txGroup,a=t.signedTxns,o=t.initiatorAddr,e.prev=1,u=s[yt.ASSET1_OUT_TXN].txn.amount,c=s[yt.ASSET2_OUT_TXN].txn.amount,p=s[yt.LIQUDITY_IN_TXN].txn.amount,e.next=7,De({client:n,pool:r,accountAddr:o});case 7:return l=e.sent,e.next=10,q(n,[a]);case 10:return d=e.sent,f=T(d,1),A=f[0],I=A.confirmedRound,g=A.txnID,e.next=17,De({client:n,pool:r,accountAddr:o});case 17:return m=e.sent,(h=m.excessAsset1-l.excessAsset1)<0n&&(h=0n),(x=m.excessAsset2-l.excessAsset2)<0n&&(x=0n),e.abrupt("return",{round:I,fees:Y(s),asset1ID:r.asset1ID,asset1Out:BigInt(u)+h,asset2ID:r.asset2ID,asset2Out:BigInt(c)+x,liquidityID:r.liquidityTokenID,liquidityIn:BigInt(p),excessAmounts:[{assetID:r.asset1ID,excessAmountForBurning:h,totalExcessAmount:m.excessAsset1},{assetID:r.asset2ID,excessAmountForBurning:x,totalExcessAmount:m.excessAsset2}],txnID:g,groupID:W(s)});case 25:throw e.prev=25,e.t0=e.catch(1),"SlippageTolerance"===(E=new B(e.t0,"We encountered something unexpected while burning liquidity. Try again later.")).type&&E.setMessage("The burn failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),E;case 30:case"end":return e.stop()}}),e,null,[[1,25]])})))).apply(this,arguments)}var _t,St,kt=3n,Bt=1000n;function Rt(){return(Rt=c(i().mark((function e(t){var n,s,a,o,u,c,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pool,s=t.txGroup,a=t.initiatorSigner,e.next=3,a([s]);case 3:return o=e.sent,u=T(o,2),c=u[0],p=u[1],l=s.map((function(e,t){return t===St.FEE_TXN_INDEX?c:t===St.ASSET_IN_TXN_INDEX?p:r.default.signLogicSigTransactionObject(e.txn,n.account.lsig).blob})),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}exports.SwapType=void 0,(_t=exports.SwapType||(exports.SwapType={})).FixedInput="fixed-input",_t.FixedOutput="fixed-output",function(e){e[e.FEE_TXN_INDEX=0]="FEE_TXN_INDEX",e[e.VALIDATOR_APP_CALL_TXN_INDEX=1]="VALIDATOR_APP_CALL_TXN_INDEX",e[e.ASSET_IN_TXN_INDEX=2]="ASSET_IN_TXN_INDEX",e[e.ASSET_OUT_TXN_INDEX=3]="ASSET_OUT_TXN_INDEX"}(St||(St={}));function Pt(){return(Pt=c(i().mark((function e(t){var n,a,o,u,c,p,l,d,f,A,I,g,m,h,x,E,y;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,a=t.pool,o=t.swapType,u=t.assetIn,c=t.assetOut,p=t.slippage,l=t.initiatorAddr,d=t.poolAddress,e.next=3,n.getTransactionParams().do();case 3:return f=e.sent,A=[H("swap"),o===exports.SwapType.FixedInput?H("fi"):H("fo")],I=r.default.makeApplicationNoOpTxnFromObject({from:d,appIndex:a.validatorAppID,appArgs:A,accounts:[l],foreignAssets:0==a.asset2ID?[a.asset1ID,a.liquidityTokenID]:[a.asset1ID,a.asset2ID,a.liquidityTokenID],suggestedParams:f}),g=o===exports.SwapType.FixedOutput?J("positive",p,u.amount):u.amount,m=0===u.assetID?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:d,amount:g,suggestedParams:f}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:l,to:d,assetIndex:u.assetID,amount:g,suggestedParams:f}),h=o===exports.SwapType.FixedInput?J("negative",p,c.amount):c.amount,x=0===c.assetID?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:d,to:l,amount:h,suggestedParams:f}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:d,to:l,assetIndex:c.assetID,amount:h,suggestedParams:f}),E=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:l,to:d,amount:I.fee+x.fee,note:s,suggestedParams:f}),y=r.default.assignGroupID([E,I,m,x]),e.abrupt("return",[{txn:y[0],signers:[l]},{txn:y[1],signers:[d]},{txn:y[2],signers:[l]},{txn:y[3],signers:[d]}]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mt(e){return Qt.apply(this,arguments)}function Qt(){return(Qt=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d,f,A,I,g,m,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,s=t.signedTxns,a=t.assetIn,o=t.assetOut,u=t.initiatorAddr,e.next=3,De({client:n,pool:r,accountAddr:u});case 3:return c=e.sent,e.next=6,q(n,[s]);case 6:return p=e.sent,l=T(p,1),d=l[0],f=d.confirmedRound,A=d.txnID,e.next=13,De({client:n,pool:r,accountAddr:u});case 13:return I=e.sent,o.assetID===r.asset1ID?(g=c.excessAsset1,m=I.excessAsset1):(g=c.excessAsset2,m=I.excessAsset2),(h=m-g)<0n&&(h=0n),e.abrupt("return",{round:f,assetInID:a.assetID,assetInAmount:BigInt(a.amount),assetOutID:o.assetID,assetOutAmount:BigInt(o.amount)+h,excessAmount:{assetID:o.assetID,excessAmountForSwap:h,totalExcessAmount:m},txnID:A});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ot(e){return Ct.apply(this,arguments)}function Ct(){return(Ct=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d,f,A,I,g,m,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,s=t.signedTxns,a=t.assetIn,o=t.assetOut,u=t.initiatorAddr,e.next=3,De({client:n,pool:r,accountAddr:u});case 3:return c=e.sent,e.next=6,q(n,[s]);case 6:return p=e.sent,l=T(p,1),d=l[0],f=d.confirmedRound,A=d.txnID,e.next=13,De({client:n,pool:r,accountAddr:u});case 13:return I=e.sent,a.assetID===r.asset1ID?(g=c.excessAsset1,m=I.excessAsset1):(g=c.excessAsset2,m=I.excessAsset2),(h=m-g)<0n&&(h=0n),e.abrupt("return",{round:f,assetInID:a.assetID,assetInAmount:BigInt(a.amount)-h,assetOutID:o.assetID,assetOutAmount:BigInt(o.amount),excessAmount:{assetID:a.assetID,excessAmountForSwap:h,totalExcessAmount:m},txnID:A});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ut(){return(Ut=c(i().mark((function e(t){var n,r,s,a,u,c,p,l,d,f;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,r=t.pool,s=t.swapType,a=t.txGroup,u=t.signedTxns,c=t.initiatorAddr,r.status===Ee.READY){e.next=3;break}throw new B({pool:r,swapType:s,txGroup:a},"Trying to swap on a non-existent pool");case 3:if(e.prev=3,p={assetID:a[St.ASSET_IN_TXN_INDEX].txn.assetIndex||0,amount:a[St.ASSET_IN_TXN_INDEX].txn.amount},l={assetID:a[St.ASSET_OUT_TXN_INDEX].txn.assetIndex||0,amount:a[St.ASSET_OUT_TXN_INDEX].txn.amount},s!==exports.SwapType.FixedInput){e.next=12;break}return e.next=9,Mt({client:n,pool:r,signedTxns:u,assetIn:p,assetOut:l,initiatorAddr:c});case 9:d=e.sent,e.next=15;break;case 12:return e.next=14,Ot({client:n,pool:r,signedTxns:u,assetIn:p,assetOut:l,initiatorAddr:c});case 14:d=e.sent;case 15:return e.abrupt("return",o(o({},d),{},{groupID:W(a),fees:Y(a)}));case 18:throw e.prev=18,e.t0=e.catch(3),"SlippageTolerance"===(f=new B(e.t0,"We encountered something unexpected while swapping. Try again later.")).type&&f.setMessage("The swap failed due to too much slippage in the price. Please adjust the slippage tolerance and try again."),f;case 23:case"end":return e.stop()}}),e,null,[[3,18]])})))).apply(this,arguments)}function Lt(){return(Lt=c(i().mark((function e(t){var n,r,s,a,o,u,c,p,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=t.pool,s=t.txGroup,a=t.initiatorSigner,e.prev=1,e.next=4,jt({txGroup:s,pool:r,initiatorSigner:a});case 4:return o=e.sent,e.next=7,q(n,[o]);case 7:return u=e.sent,c=T(u,1),p=c[0],l=p.txnID,d=p.confirmedRound,e.abrupt("return",{fees:Y(s),confirmedRound:d,txnID:l,groupID:W(s)});case 15:throw e.prev=15,e.t0=e.catch(1),new B(e.t0,"We encountered something unexpected while redeeming. Try again later.");case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function jt(e){return Ft.apply(this,arguments)}function Ft(){return(Ft=c(i().mark((function e(t){var n,s,a,o,u,c,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txGroup,s=t.pool,a=t.initiatorSigner,e.next=3,a([n]);case 3:return o=e.sent,u=T(o,1),c=u[0],p=s.account.lsig,l=n.map((function(e,t){return 0===t?c:r.default.signLogicSigTransactionObject(e.txn,p).blob})),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vt(){return Vt=c(i().mark((function e(t){var n,s,a,o,u,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,s=t.data,a=t.initiatorSigner,e.prev=1,o=s.map((function(e){var t=e.txGroup,n=e.pool;return{txns:t,txnFees:Y(t),groupID:W(t),lsig:n.account.lsig}})),e.next=5,a(o.map((function(e){return e.txns})));case 5:return u=e.sent,p=Promise.all(o.map((function(e,t){return new Promise(function(){var s=c(i().mark((function s(a,o){var c,p,l,d,f,A;return i().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,c=e.txns.map((function(n,s){return 0===s?u[t]:r.default.signLogicSigTransactionObject(n.txn,e.lsig).blob})),s.next=4,q(n,[c]);case 4:p=s.sent,l=T(p,1),d=l[0],f=d.txnID,A=d.confirmedRound,a({fees:e.txnFees,groupID:e.groupID,txnID:f,confirmedRound:A}),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(0),o(s.t0);case 15:case"end":return s.stop()}}),s,null,[[0,12]])})));return function(e,t){return s.apply(this,arguments)}}())}))),e.abrupt("return",p);case 10:throw e.prev=10,e.t0=e.catch(1),new B(e.t0,"We encountered something unexpected while redeeming. Try again later.");case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),Vt.apply(this,arguments)}function Jt(){return(Jt=c(i().mark((function e(t){var n,a,o,u,c,p,l,d,f,A,I;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,a=t.pool,o=t.assetID,u=t.assetOut,c=t.initiatorAddr,p=t.poolAddress,e.next=3,n.getTransactionParams().do();case 3:return l=e.sent,d=r.default.makeApplicationNoOpTxnFromObject({from:p,appIndex:a.validatorAppID,appArgs:[H("redeem")],accounts:[c],foreignAssets:0==a.asset2ID?[a.asset1ID,a.liquidityTokenID]:[a.asset1ID,a.asset2ID,a.liquidityTokenID],suggestedParams:l}),f=0===o?r.default.makePaymentTxnWithSuggestedParamsFromObject({from:p,to:c,amount:BigInt(u),suggestedParams:l}):r.default.makeAssetTransferTxnWithSuggestedParamsFromObject({from:p,to:c,assetIndex:o,amount:BigInt(u),suggestedParams:l}),A=r.default.makePaymentTxnWithSuggestedParamsFromObject({from:c,to:p,amount:d.fee+f.fee,note:s,suggestedParams:l}),I=r.default.assignGroupID([A,d,f]),e.abrupt("return",[{txn:I[0],signers:[c]},{txn:I[1],signers:[p]},{txn:I[2],signers:[p]}]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xt(t){var n=t.suggestedParams,r=t.stakingAppID,s=t.initiatorAddr,a=t.liquidityAssetID,o=t.program,i=t.amount,u=e.encodeUint64(i),c=e.encodeUint64(o.id);return e.makeApplicationNoOpTxnFromObject({appIndex:r,from:s,suggestedParams:n,foreignAssets:[a],accounts:[o.accountAddress],appArgs:[H("commit"),u],note:P([H("tinymanStaking/v1:b"),c,e.encodeUint64(a),u])})}function Gt(){return(Gt=c(i().mark((function t(n){var r,s,a,o,u,c,p,l,d,f,A;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.client,s=n.stakingAppID,a=n.program,o=n.requiredAssetID,u=n.liquidityAssetID,c=n.amount,p=n.initiatorAddr,t.next=3,r.getTransactionParams().do();case 3:if(l=t.sent,d=Xt({suggestedParams:l,stakingAppID:s,program:a,liquidityAssetID:u,initiatorAddr:p,amount:c}),f=[d],"number"!=typeof o){t.next=10;break}return A=e.makeApplicationNoOpTxnFromObject({appIndex:s,from:p,suggestedParams:l,foreignAssets:[o],accounts:[a.accountAddress],appArgs:[H("log_balance")]}),f=e.assignGroupID([d,A]),t.abrupt("return",[{txn:f[0],signers:[p]},{txn:f[1],signers:[p]}]);case 10:return t.abrupt("return",[{txn:f[0],signers:[p]}]);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}exports.ALGO_ASSET=K,exports.ALGO_ASSET_ID=0,exports.ASSET_OPT_IN_PROCESS_TXN_COUNT=1,exports.BASE_MINIMUM_BALANCE=1e5,exports.BURN_PROCESS_TXN_COUNT=5,exports.CONTRACT_VERSION=se,exports.LIQUIDITY_TOKEN_UNIT_NAME=$,exports.MINIMUM_BALANCE_REQUIRED_PER_APP=1e5,exports.MINIMUM_BALANCE_REQUIRED_PER_ASSET=1e5,exports.MINIMUM_BALANCE_REQUIRED_PER_BYTE_SCHEMA=5e4,exports.MINIMUM_BALANCE_REQUIRED_PER_INT_SCHEMA_VALUE=28500,exports.MINIMUM_LIQUIDITY_MINTING_AMOUNT=1e3,exports.Mint=vt,exports.OPT_IN_VALIDATOR_APP_PROCESS_TXN_COUNT=1,exports.OPT_OUT_VALIDATOR_APP_PROCESS_TXN_COUNT=1,exports.REDEEM_PROCESS_TXN_COUNT=3,exports.SWAP_PROCESS_TXN_COUNT=4,exports.applySlippageToAmount=J,exports.burnLiquidity=function(e){return wt.apply(this,arguments)},exports.calculateAccountMinimumRequiredBalance=xe,exports.calculatePoolBootstrapFundingTxnAmount=Ge,exports.convertFromBaseUnits=X,exports.convertToBaseUnits=function(e,t){return G({decimalPlaces:0},Math.pow(10,Number(e))*Number(t))},exports.createPool=function(e,t,n,r){return Ze.apply(this,arguments)},exports.generateBootstrapTransactions=function(e){return qe.apply(this,arguments)},exports.generateBurnTxns=function(e){return Nt.apply(this,arguments)},exports.generateOptIntoAssetTxns=function(e){return ee.apply(this,arguments)},exports.generateOptIntoValidatorTxns=function(e){return ce.apply(this,arguments)},exports.generateOptOutOfValidatorTxns=function(e){return pe.apply(this,arguments)},exports.generateRedeemTxns=function(e){return Jt.apply(this,arguments)},exports.generateSwapTransactions=function(e){return Pt.apply(this,arguments)},exports.getAccountExcess=function(e){return Ne.apply(this,arguments)},exports.getAccountExcessWithinPool=De,exports.getAccountInformation=me,exports.getBootstrapProcessTxnCount=function(e){return 0===e?4:5},exports.getBurnLiquidityQuote=function(e){var t=e.pool,n=e.reserves,r=e.liquidityIn,s=BigInt(r),a=n.issuedLiquidity&&s*n.asset1/n.issuedLiquidity,o=n.issuedLiquidity&&s*n.asset2/n.issuedLiquidity;return{round:n.round,liquidityID:t.liquidityTokenID,liquidityIn:s,asset1ID:t.asset1ID,asset1Out:a,asset2ID:t.asset2ID,asset2Out:o}},exports.getStakingAppID=function(e){return"testnet"===e?51948952:649588853},exports.getSwapQuote=function(e,t,n,r,s){var a;if(t.status!==Ee.READY)throw new B({pool:t,asset:r},"Trying to swap on a non-existent pool");return a="fixed-input"===e?function(e){var t,n,r,s=e.pool,a=e.reserves,o=e.assetIn,i=e.decimals,u=BigInt(o.amount);o.assetID===s.asset1ID?(t=s.asset2ID,n=a.asset1,r=a.asset2):(t=s.asset1ID,n=a.asset2,r=a.asset1);var c=u*kt/Bt,p=r-n*r/(n+(u-c));if(p>r)throw new Error("Output amount exceeds available liquidity.");var l=X(i.assetOut,Number(p))/X(i.assetIn,Number(u)),d=X(i.assetOut,Number(r))/X(i.assetIn,Number(n)),f=G({decimalPlaces:5},Math.abs(l/d-1));return{round:a.round,assetInID:o.assetID,assetInAmount:u,assetOutID:t,assetOutAmount:p,swapFee:Number(c),rate:l,priceImpact:f}}({pool:t,reserves:n,assetIn:r,decimals:s}):function(e){var t,n,r,s=e.pool,a=e.reserves,o=e.assetOut,i=e.decimals,u=BigInt(o.amount);if(o.assetID===s.asset1ID?(t=s.asset2ID,n=a.asset2,r=a.asset1):(t=s.asset1ID,n=a.asset1,r=a.asset2),u>r)throw new Error("Output amount exceeds available liquidity.");var c=n*r/(r-u)-n,p=c*Bt/(Bt-kt),l=p-c,d=X(i.assetOut,Number(u))/X(i.assetIn,Number(p)),f=X(i.assetOut,Number(r))/X(i.assetIn,Number(n)),A=G({decimalPlaces:5},Math.abs(d/f-1));return{round:a.round,assetInID:t,assetInAmount:p,assetOutID:o.assetID,assetOutAmount:u,swapFee:Number(l),rate:d,priceImpact:A}}({pool:t,reserves:n,assetOut:r,decimals:s}),a},exports.getTxnGroupID=W,exports.getValidatorAppID=ue,exports.hasSufficientMinimumBalance=function(e){return e.amount>=e.minimum_required_balance},exports.isAccountOptedIntoApp=function(e){var t=e.appID;return e.accountAppsLocalState.some((function(e){return e.id===t}))},exports.issueSwap=function(e){return Ut.apply(this,arguments)},exports.poolUtils=Xe,exports.prepareCommitTransactions=function(e){return Gt.apply(this,arguments)},exports.redeemAllExcessAsset=function(e){return Vt.apply(this,arguments)},exports.redeemExcessAsset=function(e){return Lt.apply(this,arguments)},exports.sendAndWaitRawTransaction=q,exports.signBootstrapTransactions=function(e){return ze.apply(this,arguments)},exports.signBurnTxns=function(e){return bt.apply(this,arguments)},exports.signSwapTransactions=function(e){return Rt.apply(this,arguments)},exports.sumUpTxnFees=Y,exports.tinymanContract_v1_1=de,exports.tinymanContract_v2=Ie;
